(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{piSE:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{}},qZlX:function(e,t,r){"use strict";r.r(t),r.d(t,"ReportsModule",(function(){return D}));var n=r("ofXK"),o=r("tyNb"),a=r("3Pt+"),i=r("M0ag"),p=r("piSE"),m=r("za27"),l=r("fXoL"),s=r("dJ3e"),d=r("JqCM"),y=r("kmnG"),c=r("qFsG"),u=r("iadO"),f=r("d3UM"),h=r("bTqV"),T=r("FKr1");function g(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"mat-option",19),l["\u0275\u0275listener"]("click",(function(){l["\u0275\u0275restoreView"](e);const r=t.$implicit;return l["\u0275\u0275nextContext"](2).setReportType(r)})),l["\u0275\u0275text"](1),l["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;l["\u0275\u0275property"]("value",e),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",e.name," ")}}function v(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"mat-option",19),l["\u0275\u0275listener"]("click",(function(){l["\u0275\u0275restoreView"](e);const r=t.$implicit;return l["\u0275\u0275nextContext"](3).setPaymentType(r.id)})),l["\u0275\u0275text"](1),l["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;l["\u0275\u0275property"]("value",e.id),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",e.paymentDescription," ")}}function R(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"mat-form-field",5),l["\u0275\u0275elementStart"](1,"mat-label"),l["\u0275\u0275text"](2,"Payment Type:"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](3,"mat-select",20),l["\u0275\u0275template"](4,v,2,2,"mat-option",13),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"](2);l["\u0275\u0275advance"](4),l["\u0275\u0275property"]("ngForOf",e.paymentTypeList)}}function E(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"mat-option",23),l["\u0275\u0275text"](1),l["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;l["\u0275\u0275property"]("value",e.id),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",e.companyName," ")}}function M(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"mat-form-field",5),l["\u0275\u0275elementStart"](1,"mat-label"),l["\u0275\u0275text"](2,"Company:"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](3,"mat-select",21),l["\u0275\u0275template"](4,E,2,2,"mat-option",22),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"](2);l["\u0275\u0275advance"](4),l["\u0275\u0275property"]("ngForOf",e.activeCompanyList)}}function S(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"mat-option",23),l["\u0275\u0275text"](1),l["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;l["\u0275\u0275property"]("value",e.id),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",e.name," ")}}function F(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"mat-form-field",5),l["\u0275\u0275elementStart"](1,"mat-label"),l["\u0275\u0275text"](2,"Applicant:"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](3,"mat-select",24),l["\u0275\u0275template"](4,S,2,2,"mat-option",22),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"](2);l["\u0275\u0275advance"](4),l["\u0275\u0275property"]("ngForOf",e.applicants)}}function C(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"mat-option",23),l["\u0275\u0275text"](1),l["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;l["\u0275\u0275property"]("value",e.id),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",e.name," ")}}function _(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"mat-form-field",5),l["\u0275\u0275elementStart"](1,"mat-label"),l["\u0275\u0275text"](2,"Screener:"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](3,"mat-select",25),l["\u0275\u0275template"](4,C,2,2,"mat-option",22),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"](2);l["\u0275\u0275advance"](4),l["\u0275\u0275property"]("ngForOf",e.screeners)}}function P(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"mat-option",23),l["\u0275\u0275text"](1),l["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;l["\u0275\u0275property"]("value",e.id),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",null==e?null:e.description," ")}}function A(e,t){if(1&e&&(l["\u0275\u0275elementStart"](0,"mat-form-field",5),l["\u0275\u0275elementStart"](1,"mat-label"),l["\u0275\u0275text"](2,"Mediums:"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](3,"mat-select",26),l["\u0275\u0275template"](4,P,2,2,"mat-option",22),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e){const e=l["\u0275\u0275nextContext"](2);l["\u0275\u0275advance"](4),l["\u0275\u0275property"]("ngForOf",e.typeOfMediums)}}function x(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div"),l["\u0275\u0275elementStart"](1,"form",4),l["\u0275\u0275elementStart"](2,"div",1),l["\u0275\u0275elementStart"](3,"mat-form-field",5),l["\u0275\u0275elementStart"](4,"mat-label"),l["\u0275\u0275text"](5,"Date Start:"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](6,"input",6),l["\u0275\u0275listener"]("ngModelChange",(function(t){return l["\u0275\u0275restoreView"](e),l["\u0275\u0275nextContext"]().dateFrome=t})),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](7,"mat-datepicker-toggle",7),l["\u0275\u0275element"](8,"mat-datepicker",8,9),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"mat-form-field",5),l["\u0275\u0275elementStart"](11,"mat-label"),l["\u0275\u0275text"](12,"Date End:"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](13,"input",10),l["\u0275\u0275listener"]("ngModelChange",(function(t){return l["\u0275\u0275restoreView"](e),l["\u0275\u0275nextContext"]().dateTo=t})),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](14,"mat-datepicker-toggle",7),l["\u0275\u0275element"](15,"mat-datepicker",8,11),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](17,"div",1),l["\u0275\u0275elementStart"](18,"mat-form-field",5),l["\u0275\u0275elementStart"](19,"mat-label"),l["\u0275\u0275text"](20,"Report Type: "),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](21,"mat-select",12),l["\u0275\u0275listener"]("ngModelChange",(function(t){return l["\u0275\u0275restoreView"](e),l["\u0275\u0275nextContext"]().reportType=t})),l["\u0275\u0275template"](22,g,2,2,"mat-option",13),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](23,R,5,1,"mat-form-field",14),l["\u0275\u0275template"](24,M,5,1,"mat-form-field",14),l["\u0275\u0275template"](25,F,5,1,"mat-form-field",14),l["\u0275\u0275template"](26,_,5,1,"mat-form-field",14),l["\u0275\u0275template"](27,A,5,1,"mat-form-field",14),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](28,"div",1),l["\u0275\u0275element"](29,"div",15),l["\u0275\u0275elementStart"](30,"div",16),l["\u0275\u0275elementStart"](31,"button",17),l["\u0275\u0275listener"]("click",(function(){return l["\u0275\u0275restoreView"](e),l["\u0275\u0275nextContext"]().generateReport()})),l["\u0275\u0275elementStart"](32,"i",18),l["\u0275\u0275text"](33,"task_alt"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](34," GENERATE "),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](35,"br"),l["\u0275\u0275element"](36,"br"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}if(2&e){const e=l["\u0275\u0275reference"](9),t=l["\u0275\u0275reference"](16),r=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("formGroup",r.reportForm),l["\u0275\u0275advance"](5),l["\u0275\u0275property"]("matDatepicker",e)("ngModel",r.dateFrome),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("for",e),l["\u0275\u0275advance"](6),l["\u0275\u0275property"]("matDatepicker",t)("ngModel",r.dateTo),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("for",t),l["\u0275\u0275advance"](7),l["\u0275\u0275property"]("ngModel",r.reportType),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngForOf",r.reportTypeList),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",r.selectedReportType!==r.reportTypes.VAT_SUMMARY&&r.selectedReportType!==r.reportTypes.TAX_SUMMARY),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",r.selectedReportType===r.reportTypes.COLLECTION_REPORT||r.selectedReportType===r.reportTypes.REPORT_PER_COMPANY||r.selectedReportType===r.reportTypes.REPORT_PER_AGENCY),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",r.selectedReportType===r.reportTypes.COLLECTION_REPORT||r.selectedReportType===r.reportTypes.REPORT_PER_APPLICANT),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",r.selectedReportType===r.reportTypes.COLLECTION_REPORT||r.selectedReportType===r.reportTypes.REPORT_PER_SCREENER),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf",r.selectedReportType===r.reportTypes.REPORT_PER_MEDIUM),l["\u0275\u0275advance"](4),l["\u0275\u0275property"]("disabled",(null==r.reportForm.controls.dateFrom||null==r.reportForm.controls.dateFrom.errors?null:r.reportForm.controls.dateFrom.errors.required)||(null==r.reportForm.controls.dateTo||null==r.reportForm.controls.dateTo.errors?null:r.reportForm.controls.dateTo.errors.required)||(null==r.reportForm.controls.reportType||null==r.reportForm.controls.reportType.errors?null:r.reportForm.controls.reportType.errors.required)||!r.isPaymentTypeRequired)}}function O(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"mat-option",19),l["\u0275\u0275listener"]("click",(function(){l["\u0275\u0275restoreView"](e);const r=t.$implicit;return l["\u0275\u0275nextContext"](2).setReportType(r.filename)})),l["\u0275\u0275text"](1),l["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;l["\u0275\u0275property"]("value",e.filename),l["\u0275\u0275advance"](1),l["\u0275\u0275textInterpolate1"](" ",e.name," ")}}function w(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div"),l["\u0275\u0275elementStart"](1,"form",4),l["\u0275\u0275elementStart"](2,"div",1),l["\u0275\u0275elementStart"](3,"mat-form-field",5),l["\u0275\u0275elementStart"](4,"mat-label"),l["\u0275\u0275text"](5,"Date Start:"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](6,"input",6),l["\u0275\u0275listener"]("ngModelChange",(function(t){return l["\u0275\u0275restoreView"](e),l["\u0275\u0275nextContext"]().dateFrome=t})),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](7,"mat-datepicker-toggle",7),l["\u0275\u0275element"](8,"mat-datepicker",8,9),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"mat-form-field",5),l["\u0275\u0275elementStart"](11,"mat-label"),l["\u0275\u0275text"](12,"Date End:"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](13,"input",10),l["\u0275\u0275listener"]("ngModelChange",(function(t){return l["\u0275\u0275restoreView"](e),l["\u0275\u0275nextContext"]().dateTo=t})),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](14,"mat-datepicker-toggle",7),l["\u0275\u0275element"](15,"mat-datepicker",8,11),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](17,"mat-form-field",5),l["\u0275\u0275elementStart"](18,"mat-label"),l["\u0275\u0275text"](19,"Report Type: "),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](20,"mat-select",12),l["\u0275\u0275listener"]("ngModelChange",(function(t){return l["\u0275\u0275restoreView"](e),l["\u0275\u0275nextContext"]().reportType=t})),l["\u0275\u0275template"](21,O,2,2,"mat-option",13),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](22,"div",1),l["\u0275\u0275element"](23,"div",15),l["\u0275\u0275elementStart"](24,"div",16),l["\u0275\u0275elementStart"](25,"button",17),l["\u0275\u0275listener"]("click",(function(){return l["\u0275\u0275restoreView"](e),l["\u0275\u0275nextContext"]().generateReport()})),l["\u0275\u0275elementStart"](26,"i",18),l["\u0275\u0275text"](27,"task_alt"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275text"](28," GENERATE "),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](29,"br"),l["\u0275\u0275element"](30,"br"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}if(2&e){const e=l["\u0275\u0275reference"](9),t=l["\u0275\u0275reference"](16),r=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("formGroup",r.newReportForm),l["\u0275\u0275advance"](5),l["\u0275\u0275property"]("matDatepicker",e)("ngModel",r.dateFrome),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("for",e),l["\u0275\u0275advance"](6),l["\u0275\u0275property"]("matDatepicker",t)("ngModel",r.dateTo),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("for",t),l["\u0275\u0275advance"](6),l["\u0275\u0275property"]("ngModel",r.reportType),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngForOf",r.newReportTypeList),l["\u0275\u0275advance"](4),l["\u0275\u0275property"]("disabled",(null==r.newReportForm.controls.dateFrom||null==r.newReportForm.controls.dateFrom.errors?null:r.newReportForm.controls.dateFrom.errors.required)||(null==r.newReportForm.controls.reportType||null==r.newReportForm.controls.reportType.errors?null:r.newReportForm.controls.reportType.errors.required))}}const I=[{path:"",component:(()=>{class e{constructor(e,t,r,n,o,a){this.dataStorage=e,this.apiService=t,this.formBuilder=r,this.sweetAlertService=n,this.datepipe=o,this.spinner=a,this.report=new m.a,this.paymentMethod=new p.a,this.reportTypes=i.y,this.reportTypeList=[{name:i.y.VAT_SUMMARY,filename:"VAT_TAX_Summary"},{name:i.y.TAX_SUMMARY,filename:"VAT_TAX_Summary"},{name:i.y.REPORT_PER_COMPANY,filename:"Per_Company"},{name:i.y.REPORT_PER_AGENCY,filename:"Per_Agency"},{name:i.y.REPORT_PER_SCREENER,filename:"Per_Screener"},{name:i.y.REPORT_PER_MEDIUM,filename:"Per_Type_Of_Medium"},{name:i.y.REPORT_PER_APPLICANT,filename:"Per_Applicant"}],this.applicants=[],this.screeners=[],this.newReportTypeList=[{name:"Application Per Decision",filename:"Application_Per_Decision"},{name:"Screeners Productivity",filename:"Screeners_Productivity"},{name:"Ad Specialists-Encoders",filename:"Ad_Specialists-Encoders"},{name:"Top 20 Agencies",filename:"Top_20_Agencies"},{name:"Top 20 Categories(by Decision)",filename:"Top_20_Categories(by_Decision)"},{name:"Top 5 Categories Disapproval",filename:"Top_5_Categories_Disapproval"},{name:"Top 5 Agencies Disapproval",filename:"Top_5_Agencies_Disapproval"},{name:"Decision Per Type of medium",filename:"Decision_per_type_of_medium"},{name:"Top 20 Clients(with Medium)",filename:"Top_20_Clients(with_Medium)"},{name:"Top 20 Categories(with Medium)",filename:"Top_20_Categories(with_Medium)"},{name:"Top 20 Clients",filename:"Top_20_Clients"},{name:"Top 20 Agencies(with client)",filename:"Top_20_Agencies(with_client)"}],this.paymentTypeList=[],this.activeCompanyList=[],this.isPaymentTypeRequired=!0,this.paymentTypeAll={id:0,paymentDescription:"All"}}ngOnInit(){this.currentUser=this.dataStorage.getUserAccount(),this.setFormValidator(),this.getPaymentType(),this.getActiveCompanies(),console.log(this.currentUser.userRole.name),this.getApplicants(),this.getScreeners(),this.getTypeOfMediums()}ngOnDestroy(){}getApplicants(){this.apiService.findAll(i.n.userAccountType+"/APPLICANT").subscribe(e=>{var t,r,n;this.applicants.push({name:"ALL",id:0}),(null===(t=null==e?void 0:e.responseData)||void 0===t?void 0:t.data)&&(null===(n=null===(r=null==e?void 0:e.responseData)||void 0===r?void 0:r.data)||void 0===n?void 0:n.length)&&e.responseData.data.filter(e=>{this.applicants.push({name:`${e.firstName} ${e.middleName} ${e.lastName}`,id:e.id})})})}setFormValidator(){"ROLE_ACCOUNTING"===this.currentUser.userRole.name?this.reportForm=this.formBuilder.group({reportType:["",[a.H.required]],paymentType:[0],company:[0],applicant:[0],screener:[0],medium:[0],dateFrom:["",[a.H.required]],dateTo:["",[a.H.required]]}):this.newReportForm=this.formBuilder.group({reportType:["",[a.H.required]],dateFrom:["",[a.H.required]],dateTo:["",[a.H.required]]})}getPaymentType(){this.apiService.findAll(i.n.paymentType).subscribe(e=>{this.paymentTypeList=e.responseData.data,this.paymentTypeList.unshift(this.paymentTypeAll)})}getScreeners(){this.apiService.findAll(i.n.userPerRole+"8").subscribe(e=>{var t,r,n;this.screeners.push({name:"ALL",id:0}),(null===(t=null==e?void 0:e.responseData)||void 0===t?void 0:t.data)&&(null===(n=null===(r=null==e?void 0:e.responseData)||void 0===r?void 0:r.data)||void 0===n?void 0:n.length)&&e.responseData.data.filter(e=>{this.screeners.push({name:`${e.firstName} ${e.middleName} ${e.lastName}`,id:e.id})})})}getTypeOfMediums(){this.apiService.findAll(""+i.n.typeOfMedium).subscribe(e=>{this.typeOfMediums=e.responseData.data,this.typeOfMediums.unshift({description:"ALL",id:0})})}getActiveCompanies(){this.apiService.findAll(i.n.activeCompanies).subscribe(e=>{this.activeCompanyList=e.responseData.data,this.activeCompanyList.push({id:0,companyName:"All"}),this.activeCompanyList.sort((e,t)=>e.id-t.id)})}setReportType(e){"ROLE_ACCOUNTING"===this.currentUser.userRole.name?(this.selectedReportType=e.name,"Collection Report"===this.selectedReportType?this.isPaymentTypeRequired=!1:(this.reportForm.get("paymentType").patchValue(0),this.isPaymentTypeRequired=!0,this.selectedPaymentType=0)):this.selectedReportType=e}setPaymentType(e){this.isPaymentTypeRequired=!0,this.selectedPaymentType=e}generateReport(){if(this.spinner.show(),this.report.format="xlsx",console.log("selected ",this.selectedReportType),"ROLE_ACCOUNTING"===this.currentUser.userRole.name){this.report.filename="VAT_TAX_Summary",this.report.module="Report",this.report.params={dateFrom:""+this.datepipe.transform(this.reportForm.get("dateFrom").value,"MM/dd/yyyy").toString(),dateTo:""+this.datepipe.transform(this.reportForm.get("dateTo").value,"MM/dd/yyyy"),reportType:this.reportType.filename};let e=i.n.validateReportsCollection+`/date-from/${this.datepipe.transform(this.reportForm.get("dateFrom").value,"yyyy-MM-dd").toString()}/date-to/${this.datepipe.transform(this.reportForm.get("dateTo").value,"yyyy-MM-dd").toString()}`;"Collection Report"===this.selectedReportType?(this.report.filename="Collection_Report",e=i.n.validateReportsCollection+`/date-from/${this.datepipe.transform(this.reportForm.get("dateFrom").value,"yyyy-MM-dd").toString()}/date-to/${this.datepipe.transform(this.reportForm.get("dateTo").value,"yyyy-MM-dd").toString()}/payment-type-id/${this.selectedPaymentType}`,this.report.params={dateFrom:""+this.datepipe.transform(this.reportForm.get("dateFrom").value,"MM/dd/yyyy").toString(),dateTo:""+this.datepipe.transform(this.reportForm.get("dateTo").value,"MM/dd/yyyy"),paymentTypeId:this.selectedPaymentType}):this.selectedReportType===i.y.REPORT_PER_COMPANY?(this.report.filename="Per_Company",e=i.n.validateReportsCollection+`/date-from/${this.datepipe.transform(this.reportForm.get("dateFrom").value,"yyyy-MM-dd").toString()}/date-to/${this.datepipe.transform(this.reportForm.get("dateTo").value,"yyyy-MM-dd").toString()}/payment-type-id/${this.selectedPaymentType}`,this.report.params={companyId:this.reportForm.get("company").value,dateFrom:""+this.datepipe.transform(this.reportForm.get("dateFrom").value,"MM/dd/yyyy").toString(),dateTo:""+this.datepipe.transform(this.reportForm.get("dateTo").value,"MM/dd/yyyy"),paymentTypeId:this.selectedPaymentType}):this.selectedReportType===i.y.REPORT_PER_AGENCY?(this.report.filename="Per_Agency",e=i.n.validateReportsCollection+`/date-from/${this.datepipe.transform(this.reportForm.get("dateFrom").value,"yyyy-MM-dd").toString()}/date-to/${this.datepipe.transform(this.reportForm.get("dateTo").value,"yyyy-MM-dd").toString()}/payment-type-id/${this.selectedPaymentType}`,this.report.params={agencyId:this.reportForm.get("company").value,dateFrom:""+this.datepipe.transform(this.reportForm.get("dateFrom").value,"MM/dd/yyyy").toString(),dateTo:""+this.datepipe.transform(this.reportForm.get("dateTo").value,"MM/dd/yyyy"),paymentTypeId:this.selectedPaymentType}):this.selectedReportType===i.y.REPORT_PER_SCREENER?(this.report.filename="Per_Screener",e=i.n.validateReportsCollection+`/date-from/${this.datepipe.transform(this.reportForm.get("dateFrom").value,"yyyy-MM-dd").toString()}/date-to/${this.datepipe.transform(this.reportForm.get("dateTo").value,"yyyy-MM-dd").toString()}/payment-type-id/${this.selectedPaymentType}`,this.report.params={screenerId:this.reportForm.get("screener").value,dateFrom:""+this.datepipe.transform(this.reportForm.get("dateFrom").value,"MM/dd/yyyy").toString(),dateTo:""+this.datepipe.transform(this.reportForm.get("dateTo").value,"MM/dd/yyyy"),paymentTypeId:this.selectedPaymentType}):this.selectedReportType===i.y.REPORT_PER_APPLICANT?(this.report.filename="Per_Applicant",e=i.n.validateReportsCollection+`/date-from/${this.datepipe.transform(this.reportForm.get("dateFrom").value,"yyyy-MM-dd").toString()}/date-to/${this.datepipe.transform(this.reportForm.get("dateTo").value,"yyyy-MM-dd").toString()}/payment-type-id/${this.selectedPaymentType}`,this.report.params={applicantId:this.reportForm.get("applicant").value,dateFrom:""+this.datepipe.transform(this.reportForm.get("dateFrom").value,"MM/dd/yyyy").toString(),dateTo:""+this.datepipe.transform(this.reportForm.get("dateTo").value,"MM/dd/yyyy"),paymentTypeId:this.selectedPaymentType}):this.selectedReportType===i.y.REPORT_PER_MEDIUM?(this.report.filename="Per_Type_Of_Medium",e=i.n.validateReportsCollection+`/date-from/${this.datepipe.transform(this.reportForm.get("dateFrom").value,"yyyy-MM-dd").toString()}/date-to/${this.datepipe.transform(this.reportForm.get("dateTo").value,"yyyy-MM-dd").toString()}/payment-type-id/${this.selectedPaymentType}`,this.report.params={typeOfMediumId:this.reportForm.get("medium").value,dateFrom:""+this.datepipe.transform(this.reportForm.get("dateFrom").value,"MM/dd/yyyy").toString(),dateTo:""+this.datepipe.transform(this.reportForm.get("dateTo").value,"MM/dd/yyyy"),paymentTypeId:this.selectedPaymentType}):"VAT Summary"===this.selectedReportType?this.report.params={dateFrom:""+this.datepipe.transform(this.reportForm.get("dateFrom").value,"MM/dd/yyyy").toString(),dateTo:""+this.datepipe.transform(this.reportForm.get("dateTo").value,"MM/dd/yyyy"),reportType:"vat"}:"TAX Summary"===this.selectedReportType&&(this.report.params={dateFrom:""+this.datepipe.transform(this.reportForm.get("dateFrom").value,"MM/dd/yyyy").toString(),dateTo:""+this.datepipe.transform(this.reportForm.get("dateTo").value,"MM/dd/yyyy"),reportType:"wtax"}),this.apiService.findAll(e).subscribe(e=>{e.length>0?this.printReport(this.report):(this.sweetAlertService.customErrorMessage("No Record found on date ranged"),this.spinner.hide())})}else{this.report.filename=this.selectedReportType;let e=""+this.datepipe.transform(this.newReportForm.get("dateFrom").value,"MM/dd/yyyy").toString(),t=""+this.datepipe.transform(this.newReportForm.get("dateTo").value,"MM/dd/yyyy");this.report.module="AppData",this.report.params={dateFrom:e,dateTo:t},this.printReport(this.report)}}printReport(e){this.apiService.printReport(i.n.generateReports,e).subscribe(e=>{const t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),r=URL.createObjectURL(t);var n=document.createElement("a");n.download=this.selectedReportType+".xlsx",n.href=r,n.click(),"ROLE_ACCOUNTING"===this.currentUser.userRole.name?(this.reportForm.reset(),this.reportForm.patchValue({paymentType:0,company:0,applicant:0,screener:0,medium:0})):this.newReportForm.reset(),this.selectedReportType=null,this.sweetAlertService.customSuccessMessage("Successfully Generated!"),this.spinner.hide()},e=>{this.spinner.hide(),this.sweetAlertService.customErrorMessage("No Record found on date ranged")})}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](s.c),l["\u0275\u0275directiveInject"](s.b),l["\u0275\u0275directiveInject"](a.g),l["\u0275\u0275directiveInject"](s.e),l["\u0275\u0275directiveInject"](n.f),l["\u0275\u0275directiveInject"](d.c))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["app-reports"]],decls:9,vars:2,consts:[[1,"container-fluid"],[1,"row"],[1,"col-md-12","title"],[4,"ngIf"],[3,"formGroup"],["appearance","outline",1,"col-md-6"],["matInput","","placeholder","Date","readonly","","name","dateFrom","readonly","","formControlName","dateFrom",3,"matDatepicker","ngModel","ngModelChange"],["matSuffix","",3,"for"],["color","warn","disabled","false"],["dateFrom",""],["matInput","","placeholder","Date","readonly","","name","dateTo","formControlName","dateTo",3,"matDatepicker","ngModel","ngModelChange"],["Date",""],["name","reportType","formControlName","reportType",3,"ngModel","ngModelChange"],[3,"value","click",4,"ngFor","ngForOf"],["class","col-md-6","appearance","outline",4,"ngIf"],[1,"col-md-9"],[1,"col-md-3"],["mat-raised-button","",1,"button-red",3,"disabled","click"],[1,"material-icons","color__white"],[3,"value","click"],["name","paymentType","formControlName","paymentType"],["name","company","formControlName","company"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["name","applicant","formControlName","applicant"],["name","company","formControlName","screener"],["name","medium","formControlName","medium"]],template:function(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"form"),l["\u0275\u0275elementStart"](1,"div",0),l["\u0275\u0275elementStart"](2,"div",1),l["\u0275\u0275elementStart"](3,"div",2),l["\u0275\u0275elementStart"](4,"mat-label"),l["\u0275\u0275text"](5," Reports "),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275element"](6,"hr"),l["\u0275\u0275template"](7,x,37,15,"div",3),l["\u0275\u0275template"](8,w,31,10,"div",3),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275advance"](7),l["\u0275\u0275property"]("ngIf","ROLE_ACCOUNTING"===t.currentUser.userRole.name),l["\u0275\u0275advance"](1),l["\u0275\u0275property"]("ngIf","ROLE_SUPER_ADMIN"===t.currentUser.userRole.name||"ROLE_ADMIN"===t.currentUser.userRole.name))},directives:[a.J,a.u,a.v,y.g,n.t,a.l,y.c,c.b,a.d,u.h,a.t,a.j,u.j,y.j,u.f,f.a,n.s,h.b,T.m],styles:[""]}),e})()}];let N=(()=>{class e{}return e.\u0275mod=l["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=l["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[o.f.forChild(I)],o.f]}),e})();var b=r("tk/3");let D=(()=>{class e{}return e.\u0275mod=l["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=l["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[n.c,N,b.b,a.D,i.k]]}),e})()},za27:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{}}}]);