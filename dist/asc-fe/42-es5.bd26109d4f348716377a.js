!function(){function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,n){if(!e)return;if("string"==typeof e)return t(e,n);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return t(e,n)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function r(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{"5h0i":function(t,a,i){"use strict";i.r(a),i.d(a,"WeeklyUserScheduleModule",(function(){return T}));var l=i("ofXK"),s=i("tk/3"),d=i("3Pt+"),o=i("M0ag"),c=i("7Tf7"),u=i("tyNb"),f=i("sWYD"),m=i("+0xr"),p=i("fXoL"),y=i("dJ3e"),h=i("kmnG"),v=i("bTqV"),D=i("d3UM"),S=i("FKr1"),b=i("iadO"),w=["calendar"];function g(e,t){if(1&e){var n=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementStart"](0,"mat-option",18),p["\u0275\u0275listener"]("click",(function(){p["\u0275\u0275restoreView"](n);var e=t.$implicit;return p["\u0275\u0275nextContext"](2).onSelectUser(e)})),p["\u0275\u0275text"](1),p["\u0275\u0275elementEnd"]()}if(2&e){var a=t.$implicit;p["\u0275\u0275property"]("value",a),p["\u0275\u0275advance"](1),p["\u0275\u0275textInterpolate1"](" ",a.firstName+" "+a.lastName," ")}}function k(e,t){if(1&e){var n=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementStart"](0,"div",14),p["\u0275\u0275elementStart"](1,"mat-calendar",19,20),p["\u0275\u0275listener"]("selectedChange",(function(e){p["\u0275\u0275restoreView"](n);var t=p["\u0275\u0275reference"](2);return p["\u0275\u0275nextContext"](2).onCalendarUpdate(e,t)})),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()}if(2&e){var a=p["\u0275\u0275nextContext"](2);p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("minDate",a.todayDate)("hidden",!a.selectedUser)("dateClass",a.isSelected(a))}}function U(e,t){if(1&e&&(p["\u0275\u0275elementStart"](0,"div",1),p["\u0275\u0275elementStart"](1,"mat-form-field",14),p["\u0275\u0275elementStart"](2,"mat-label"),p["\u0275\u0275text"](3,"ASC Internal User"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](4,"mat-select",15),p["\u0275\u0275template"](5,g,2,2,"mat-option",16),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275template"](6,k,3,3,"div",17),p["\u0275\u0275elementEnd"]()),2&e){var n=p["\u0275\u0275nextContext"]();p["\u0275\u0275advance"](5),p["\u0275\u0275property"]("ngForOf",n.users),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",n.users)}}function x(e,t){1&e&&(p["\u0275\u0275elementStart"](0,"th",21),p["\u0275\u0275text"](1," Date "),p["\u0275\u0275elementEnd"]())}function E(e,t){if(1&e){var n=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementStart"](0,"td",22),p["\u0275\u0275elementStart"](1,"button",23),p["\u0275\u0275listener"]("click",(function(){p["\u0275\u0275restoreView"](n);var e=t.$implicit;return p["\u0275\u0275nextContext"]().deleteDate(null==e?null:e.date)})),p["\u0275\u0275text"](2,"Delete"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](3,"span",24),p["\u0275\u0275text"](4),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()}if(2&e){var a=t.$implicit,r=p["\u0275\u0275nextContext"]();p["\u0275\u0275advance"](4),p["\u0275\u0275textInterpolate"](r.convertDate(null==a?null:a.date))}}function C(e,t){1&e&&p["\u0275\u0275element"](0,"tr",25)}function j(e,t){1&e&&p["\u0275\u0275element"](0,"tr",26)}var M,I,O,R=[{path:"",component:(M=function(){function t(e){n(this,t),this.apiService=e,this.selectedDates=[],this.originalUserDates=[],this.userExistingRecord=null,this.displayedColumns=["date"]}return r(t,[{key:"ngOnInit",value:function(){this.initializeUsers(),this.todayDate=new Date}},{key:"onCalendarUpdate",value:function(e,t){var n=Object(f.a)(e,"yyyy-MM-dd");if(!this.originalUserDates.find((function(e){return e===n}))){if(this.selectedDates.find((function(e){return e===n}))){var a=this.selectedDates.findIndex((function(e){return e===n}));this.selectedDates.splice(a,1)}else this.selectedDates.push(n);this.calendar.updateTodaysDate(),this.updateDataSource()}}},{key:"onSelectUser",value:function(e){this.selectedUser=e,this.initializeUserDates(this.selectedUser)}},{key:"isSelected",value:function(e){return function(t){var n;return Boolean(null===(n=e.selectedDates)||void 0===n?void 0:n.find((function(e){return Object(f.a)(t,"yyyy-MM-dd")===e})))?"selected":null}}},{key:"saveSelectedDates",value:function(){var e=this,t={account:this.selectedUser,weeklyUserScheduleDates:this.convertSelectedDates(),id:this.userExistingRecord?this.userExistingRecord.id:null};this.userExistingRecord?this.apiService.update(o.n.weeklyUserSchedule,t).subscribe((function(){e.initializeUserDates(e.selectedUser)})):this.apiService.insert(o.n.weeklyUserSchedule,Object.assign(Object.assign({},t),{weeklyUserScheduleDates:[]}),!0).subscribe((function(n){e.apiService.update(o.n.weeklyUserSchedule,Object.assign(Object.assign({},t),{id:n.responseData.data.id})).subscribe((function(){e.initializeUserDates(e.selectedUser)}))}))}},{key:"convertDate",value:function(e){return Object(f.a)(new Date(e),"MMM/dd/yyyy")}},{key:"deleteDate",value:function(e){var t=this,n=this.originalUserDates.findIndex((function(t){return t===e}));if(-1!==n){var a=this.userExistingRecord.weeklyUserScheduleDates.find((function(t){return Object(f.a)(new Date(t.scheduleDate),"yyyy-MM-dd")===Object(f.a)(new Date(e),"yyyy-MM-dd")})).id;this.apiService.deleteById(o.n.weeklyScheduledUsers,a).subscribe((function(){var r=t.userExistingRecord.weeklyUserScheduleDates.findIndex((function(e){return e.id===a}));t.userExistingRecord.weeklyUserScheduleDates.splice(r,1),t.deletionUpdate(e),t.originalUserDates.splice(n,1)}))}else this.deletionUpdate(e)}},{key:"deletionUpdate",value:function(e){var t=this.selectedDates.findIndex((function(t){return t===e}));this.selectedDates.splice(t,1),this.updateDataSource(),this.calendar.updateTodaysDate()}},{key:"updateDataSource",value:function(){this.dataSource=new m.p(this.selectedDates.sort((function(e,t){return new Date(t).valueOf()-new Date(e).valueOf()})).map((function(e){return{date:e}})))}},{key:"convertSelectedDates",value:function(){var e=this;return this.selectedDates.map((function(t){var n=null;return e.userExistingRecord&&(n=e.userExistingRecord.weeklyUserScheduleDates.find((function(e){return Object(f.a)(new Date(e.scheduleDate),"yyyy-MM-dd")===Object(f.a)(new Date(t),"yyyy-MM-dd")}))),null!=n?n:{scheduleDate:t}}))}},{key:"initializeUsers",value:function(){var e=this;this.apiService.findAll(o.n.userAccountType+"/ASC_USER").subscribe((function(t){e.users=t.responseData.data}))}},{key:"clearData",value:function(){this.selectedDates=[],this.originalUserDates=[],this.calendar.updateTodaysDate(),this.updateDataSource()}},{key:"initializeUserDates",value:function(t){var n=this;this.clearData(),this.apiService.findAll("".concat(o.n.weeklyUserScheduleCustomSearch,"?&accountId=").concat(t.id)).subscribe((function(t){t.data.length?(n.originalUserDates=(t=t.data[0]).weeklyUserScheduleDates.map((function(e){return Object(f.a)(new Date(e.scheduleDate),"yyyy-MM-dd")})),n.selectedDates=e(n.originalUserDates),n.userExistingRecord=t,n.updateDataSource(),n.calendar.updateTodaysDate()):n.userExistingRecord=null}))}}]),t}(),M.\u0275fac=function(e){return new(e||M)(p["\u0275\u0275directiveInject"](y.b))},M.\u0275cmp=p["\u0275\u0275defineComponent"]({type:M,selectors:[["app-weekly-user-schedule"]],viewQuery:function(e,t){var n;1&e&&p["\u0275\u0275viewQuery"](w,!0),2&e&&p["\u0275\u0275queryRefresh"](n=p["\u0275\u0275loadQuery"]())&&(t.calendar=n.first)},decls:21,vars:6,consts:[[1,"container-fluid"],[1,"row"],[1,"col-md-12","title"],["class","row",4,"ngIf"],[1,"mat-elevation-z8","fields"],["mat-table","","mat-sort","",3,"dataSource"],["matColumnDef","date"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[1,"no-record",3,"hidden"],[1,"col-md-12"],["mat-raised-button","",1,"button-red","col-md-3","margin",3,"hidden","click"],["appearance","outline",1,"col-md-5"],["name","status"],[3,"value","click",4,"ngFor","ngForOf"],["class","col-md-5","appearance","outline",4,"ngIf"],[3,"value","click"],[3,"minDate","hidden","dateClass","selectedChange"],["calendar",""],["mat-header-cell",""],["mat-cell",""],["mat-raised-button","",1,"button-red","col-md-1","delete-btn",3,"click"],[1,"date-text"],["mat-header-row",""],["mat-row",""]],template:function(e,t){1&e&&(p["\u0275\u0275elementStart"](0,"form"),p["\u0275\u0275elementStart"](1,"div",0),p["\u0275\u0275elementStart"](2,"div",1),p["\u0275\u0275elementStart"](3,"div",2),p["\u0275\u0275elementStart"](4,"mat-label"),p["\u0275\u0275text"](5," Weekly User Schedule "),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275element"](6,"hr"),p["\u0275\u0275elementStart"](7,"form"),p["\u0275\u0275template"](8,U,7,2,"div",3),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](9,"div",4),p["\u0275\u0275elementStart"](10,"table",5),p["\u0275\u0275elementContainerStart"](11,6),p["\u0275\u0275template"](12,x,2,0,"th",7),p["\u0275\u0275template"](13,E,5,1,"td",8),p["\u0275\u0275elementContainerEnd"](),p["\u0275\u0275template"](14,C,1,0,"tr",9),p["\u0275\u0275template"](15,j,1,0,"tr",10),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](16,"div",11),p["\u0275\u0275text"](17," No record found. "),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](18,"div",12),p["\u0275\u0275elementStart"](19,"button",13),p["\u0275\u0275listener"]("click",(function(){return t.saveSelectedDates()})),p["\u0275\u0275text"](20,"Save"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()),2&e&&(p["\u0275\u0275advance"](8),p["\u0275\u0275property"]("ngIf",t.users),p["\u0275\u0275advance"](2),p["\u0275\u0275property"]("dataSource",t.dataSource),p["\u0275\u0275advance"](4),p["\u0275\u0275property"]("matHeaderRowDef",t.displayedColumns),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("matRowDefColumns",t.displayedColumns),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("hidden",t.selectedDates&&t.selectedDates.length>0),p["\u0275\u0275advance"](3),p["\u0275\u0275property"]("hidden",0===t.selectedDates.length))},directives:[d.J,d.u,d.v,h.g,l.t,m.o,m.c,m.i,m.b,m.k,m.n,v.b,h.c,D.a,l.s,S.m,b.a,m.h,m.a,m.j,m.m],styles:[".mat-calendar-body-cell.selected{background-color:#c5140c!important;border-radius:50%}.drop-calendar{width:30rem}.margin{margin:10px!important;right:0!important;bottom:0!important}.delete-btn{float:right!important}.date-text{font-size:larger;margin:auto}"],encapsulation:2}),M)}],A=((O=r((function e(){n(this,e)}))).\u0275mod=p["\u0275\u0275defineNgModule"]({type:O}),O.\u0275inj=p["\u0275\u0275defineInjector"]({factory:function(e){return new(e||O)},imports:[[u.f.forChild(R)],u.f]}),O),T=((I=r((function e(){n(this,e)}))).\u0275mod=p["\u0275\u0275defineNgModule"]({type:I}),I.\u0275inj=p["\u0275\u0275defineInjector"]({factory:function(e){return new(e||I)},imports:[[l.c,A,s.b,d.D,o.k,c.a]]}),I)},"7Tf7":function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var i,l,s=a("ofXK"),d=a("M0ag"),o=a("tyNb"),c=a("fXoL"),u=[],f=((l=r((function e(){n(this,e)}))).\u0275mod=c["\u0275\u0275defineNgModule"]({type:l}),l.\u0275inj=c["\u0275\u0275defineInjector"]({factory:function(e){return new(e||l)},imports:[[o.f.forChild(u)],o.f]}),l),m=((i=r((function e(){n(this,e)}))).\u0275mod=c["\u0275\u0275defineNgModule"]({type:i}),i.\u0275inj=c["\u0275\u0275defineInjector"]({factory:function(e){return new(e||i)},imports:[[s.c,f,d.k]]}),i)}}])}();