(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{piSE:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{}},qZlX:function(e,t,r){"use strict";r.r(t),r.d(t,"ReportsModule",(function(){return I}));var n=r("ofXK"),o=r("tyNb"),a=r("3Pt+"),i=r("M0ag"),p=r("piSE"),l=r("za27"),m=r("fXoL"),s=r("dJ3e"),d=r("JqCM"),c=r("kmnG"),y=r("qFsG"),u=r("iadO"),f=r("d3UM"),h=r("bTqV"),T=r("FKr1");function g(e,t){if(1&e){const e=m["\u0275\u0275getCurrentView"]();m["\u0275\u0275elementStart"](0,"mat-option",19),m["\u0275\u0275listener"]("click",(function(){m["\u0275\u0275restoreView"](e);const r=t.$implicit;return m["\u0275\u0275nextContext"](2).setReportType(r)})),m["\u0275\u0275text"](1),m["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;m["\u0275\u0275property"]("value",e),m["\u0275\u0275advance"](1),m["\u0275\u0275textInterpolate1"](" ",e.name," ")}}function R(e,t){if(1&e){const e=m["\u0275\u0275getCurrentView"]();m["\u0275\u0275elementStart"](0,"mat-option",19),m["\u0275\u0275listener"]("click",(function(){m["\u0275\u0275restoreView"](e);const r=t.$implicit;return m["\u0275\u0275nextContext"](3).setPaymentType(r.id)})),m["\u0275\u0275text"](1),m["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;m["\u0275\u0275property"]("value",e.id),m["\u0275\u0275advance"](1),m["\u0275\u0275textInterpolate1"](" ",e.paymentDescription," ")}}function v(e,t){if(1&e){const e=m["\u0275\u0275getCurrentView"]();m["\u0275\u0275elementStart"](0,"mat-form-field",5),m["\u0275\u0275elementStart"](1,"mat-label"),m["\u0275\u0275text"](2,"Payment Type:"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](3,"mat-select",20),m["\u0275\u0275listener"]("ngModelChange",(function(t){return m["\u0275\u0275restoreView"](e),m["\u0275\u0275nextContext"](2).paymentMethod.paymentType=t})),m["\u0275\u0275elementStart"](4,"mat-option",19),m["\u0275\u0275listener"]("click",(function(){m["\u0275\u0275restoreView"](e);const t=m["\u0275\u0275nextContext"](2);return t.setPaymentType(t.paymentTypeAll.id)})),m["\u0275\u0275text"](5),m["\u0275\u0275elementEnd"](),m["\u0275\u0275template"](6,R,2,2,"mat-option",13),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"]()}if(2&e){const e=m["\u0275\u0275nextContext"](2);m["\u0275\u0275advance"](3),m["\u0275\u0275property"]("ngModel",e.paymentMethod.paymentType),m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("value",e.paymentTypeAll.id),m["\u0275\u0275advance"](1),m["\u0275\u0275textInterpolate1"](" ",e.paymentTypeAll.paymentDescription," "),m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("ngForOf",e.paymentTypeList)}}function E(e,t){if(1&e&&(m["\u0275\u0275elementStart"](0,"mat-option",23),m["\u0275\u0275text"](1),m["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;m["\u0275\u0275property"]("value",e.id),m["\u0275\u0275advance"](1),m["\u0275\u0275textInterpolate1"](" ",e.companyName," ")}}function S(e,t){if(1&e&&(m["\u0275\u0275elementStart"](0,"mat-form-field",5),m["\u0275\u0275elementStart"](1,"mat-label"),m["\u0275\u0275text"](2,"Company:"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](3,"mat-select",21),m["\u0275\u0275template"](4,E,2,2,"mat-option",22),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"]()),2&e){const e=m["\u0275\u0275nextContext"](2);m["\u0275\u0275advance"](4),m["\u0275\u0275property"]("ngForOf",e.activeCompanyList)}}function C(e,t){if(1&e&&(m["\u0275\u0275elementStart"](0,"mat-option",23),m["\u0275\u0275text"](1),m["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;m["\u0275\u0275property"]("value",e.id),m["\u0275\u0275advance"](1),m["\u0275\u0275textInterpolate1"](" ",e.name," ")}}function M(e,t){if(1&e&&(m["\u0275\u0275elementStart"](0,"mat-form-field",5),m["\u0275\u0275elementStart"](1,"mat-label"),m["\u0275\u0275text"](2,"Applicant:"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](3,"mat-select",24),m["\u0275\u0275template"](4,C,2,2,"mat-option",22),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"]()),2&e){const e=m["\u0275\u0275nextContext"](2);m["\u0275\u0275advance"](4),m["\u0275\u0275property"]("ngForOf",e.applicants)}}function F(e,t){if(1&e&&(m["\u0275\u0275elementStart"](0,"mat-option",23),m["\u0275\u0275text"](1),m["\u0275\u0275elementEnd"]()),2&e){const e=t.$implicit;m["\u0275\u0275property"]("value",e.id),m["\u0275\u0275advance"](1),m["\u0275\u0275textInterpolate1"](" ",e.name," ")}}function P(e,t){if(1&e&&(m["\u0275\u0275elementStart"](0,"mat-form-field",5),m["\u0275\u0275elementStart"](1,"mat-label"),m["\u0275\u0275text"](2,"Screener:"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](3,"mat-select",25),m["\u0275\u0275template"](4,F,2,2,"mat-option",22),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"]()),2&e){const e=m["\u0275\u0275nextContext"](2);m["\u0275\u0275advance"](4),m["\u0275\u0275property"]("ngForOf",e.screeners)}}function A(e,t){if(1&e){const e=m["\u0275\u0275getCurrentView"]();m["\u0275\u0275elementStart"](0,"div"),m["\u0275\u0275elementStart"](1,"form",4),m["\u0275\u0275elementStart"](2,"div",1),m["\u0275\u0275elementStart"](3,"mat-form-field",5),m["\u0275\u0275elementStart"](4,"mat-label"),m["\u0275\u0275text"](5,"Date Start:"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](6,"input",6),m["\u0275\u0275listener"]("ngModelChange",(function(t){return m["\u0275\u0275restoreView"](e),m["\u0275\u0275nextContext"]().dateFrome=t})),m["\u0275\u0275elementEnd"](),m["\u0275\u0275element"](7,"mat-datepicker-toggle",7),m["\u0275\u0275element"](8,"mat-datepicker",8,9),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](10,"mat-form-field",5),m["\u0275\u0275elementStart"](11,"mat-label"),m["\u0275\u0275text"](12,"Date End:"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](13,"input",10),m["\u0275\u0275listener"]("ngModelChange",(function(t){return m["\u0275\u0275restoreView"](e),m["\u0275\u0275nextContext"]().dateTo=t})),m["\u0275\u0275elementEnd"](),m["\u0275\u0275element"](14,"mat-datepicker-toggle",7),m["\u0275\u0275element"](15,"mat-datepicker",8,11),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](17,"div",1),m["\u0275\u0275elementStart"](18,"mat-form-field",5),m["\u0275\u0275elementStart"](19,"mat-label"),m["\u0275\u0275text"](20,"Report Type: "),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](21,"mat-select",12),m["\u0275\u0275listener"]("ngModelChange",(function(t){return m["\u0275\u0275restoreView"](e),m["\u0275\u0275nextContext"]().reportType=t})),m["\u0275\u0275template"](22,g,2,2,"mat-option",13),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"](),m["\u0275\u0275template"](23,v,7,4,"mat-form-field",14),m["\u0275\u0275template"](24,S,5,1,"mat-form-field",14),m["\u0275\u0275template"](25,M,5,1,"mat-form-field",14),m["\u0275\u0275template"](26,P,5,1,"mat-form-field",14),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](27,"div",1),m["\u0275\u0275element"](28,"div",15),m["\u0275\u0275elementStart"](29,"div",16),m["\u0275\u0275elementStart"](30,"button",17),m["\u0275\u0275listener"]("click",(function(){return m["\u0275\u0275restoreView"](e),m["\u0275\u0275nextContext"]().generateReport()})),m["\u0275\u0275elementStart"](31,"i",18),m["\u0275\u0275text"](32,"task_alt"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275text"](33," GENERATE "),m["\u0275\u0275elementEnd"](),m["\u0275\u0275element"](34,"br"),m["\u0275\u0275element"](35,"br"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"]()}if(2&e){const e=m["\u0275\u0275reference"](9),t=m["\u0275\u0275reference"](16),r=m["\u0275\u0275nextContext"]();m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("formGroup",r.reportForm),m["\u0275\u0275advance"](5),m["\u0275\u0275property"]("matDatepicker",e)("ngModel",r.dateFrome),m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("for",e),m["\u0275\u0275advance"](6),m["\u0275\u0275property"]("matDatepicker",t)("ngModel",r.dateTo),m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("for",t),m["\u0275\u0275advance"](7),m["\u0275\u0275property"]("ngModel",r.reportType),m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("ngForOf",r.reportTypeList),m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("ngIf","COLLECTION REPORT"===r.selectedReportType||"REPORT PER COMPANY"===r.selectedReportType||"REPORT PER AGENCY"===r.selectedReportType||"REPORT PER SCREENER"===r.selectedReportType),m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("ngIf","COLLECTION REPORT"===r.selectedReportType||"REPORT PER COMPANY"===r.selectedReportType),m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("ngIf","COLLECTION REPORT"===r.selectedReportType||"REPORT PER APPLICANT"===r.selectedReportType),m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("ngIf","COLLECTION REPORT"===r.selectedReportType||"REPORT PER SCREENER"===r.selectedReportType),m["\u0275\u0275advance"](4),m["\u0275\u0275property"]("disabled",(null==r.reportForm.controls.dateFrom||null==r.reportForm.controls.dateFrom.errors?null:r.reportForm.controls.dateFrom.errors.required)||(null==r.reportForm.controls.dateTo||null==r.reportForm.controls.dateTo.errors?null:r.reportForm.controls.dateTo.errors.required)||(null==r.reportForm.controls.reportType||null==r.reportForm.controls.reportType.errors?null:r.reportForm.controls.reportType.errors.required)||!r.isPaymentTypeRequired)}}function x(e,t){if(1&e){const e=m["\u0275\u0275getCurrentView"]();m["\u0275\u0275elementStart"](0,"mat-option",19),m["\u0275\u0275listener"]("click",(function(){m["\u0275\u0275restoreView"](e);const r=t.$implicit;return m["\u0275\u0275nextContext"](2).setReportType(r.filename)})),m["\u0275\u0275text"](1),m["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;m["\u0275\u0275property"]("value",e.filename),m["\u0275\u0275advance"](1),m["\u0275\u0275textInterpolate1"](" ",e.name," ")}}function w(e,t){if(1&e){const e=m["\u0275\u0275getCurrentView"]();m["\u0275\u0275elementStart"](0,"div"),m["\u0275\u0275elementStart"](1,"form",4),m["\u0275\u0275elementStart"](2,"div",1),m["\u0275\u0275elementStart"](3,"mat-form-field",5),m["\u0275\u0275elementStart"](4,"mat-label"),m["\u0275\u0275text"](5,"Date Start:"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](6,"input",6),m["\u0275\u0275listener"]("ngModelChange",(function(t){return m["\u0275\u0275restoreView"](e),m["\u0275\u0275nextContext"]().dateFrome=t})),m["\u0275\u0275elementEnd"](),m["\u0275\u0275element"](7,"mat-datepicker-toggle",7),m["\u0275\u0275element"](8,"mat-datepicker",8,9),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](10,"mat-form-field",5),m["\u0275\u0275elementStart"](11,"mat-label"),m["\u0275\u0275text"](12,"Date End:"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](13,"input",10),m["\u0275\u0275listener"]("ngModelChange",(function(t){return m["\u0275\u0275restoreView"](e),m["\u0275\u0275nextContext"]().dateTo=t})),m["\u0275\u0275elementEnd"](),m["\u0275\u0275element"](14,"mat-datepicker-toggle",7),m["\u0275\u0275element"](15,"mat-datepicker",8,11),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](17,"mat-form-field",5),m["\u0275\u0275elementStart"](18,"mat-label"),m["\u0275\u0275text"](19,"Report Type: "),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](20,"mat-select",12),m["\u0275\u0275listener"]("ngModelChange",(function(t){return m["\u0275\u0275restoreView"](e),m["\u0275\u0275nextContext"]().reportType=t})),m["\u0275\u0275template"](21,x,2,2,"mat-option",13),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementStart"](22,"div",1),m["\u0275\u0275element"](23,"div",15),m["\u0275\u0275elementStart"](24,"div",16),m["\u0275\u0275elementStart"](25,"button",17),m["\u0275\u0275listener"]("click",(function(){return m["\u0275\u0275restoreView"](e),m["\u0275\u0275nextContext"]().generateReport()})),m["\u0275\u0275elementStart"](26,"i",18),m["\u0275\u0275text"](27,"task_alt"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275text"](28," GENERATE "),m["\u0275\u0275elementEnd"](),m["\u0275\u0275element"](29,"br"),m["\u0275\u0275element"](30,"br"),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"]()}if(2&e){const e=m["\u0275\u0275reference"](9),t=m["\u0275\u0275reference"](16),r=m["\u0275\u0275nextContext"]();m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("formGroup",r.newReportForm),m["\u0275\u0275advance"](5),m["\u0275\u0275property"]("matDatepicker",e)("ngModel",r.dateFrome),m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("for",e),m["\u0275\u0275advance"](6),m["\u0275\u0275property"]("matDatepicker",t)("ngModel",r.dateTo),m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("for",t),m["\u0275\u0275advance"](6),m["\u0275\u0275property"]("ngModel",r.reportType),m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("ngForOf",r.newReportTypeList),m["\u0275\u0275advance"](4),m["\u0275\u0275property"]("disabled",(null==r.newReportForm.controls.dateFrom||null==r.newReportForm.controls.dateFrom.errors?null:r.newReportForm.controls.dateFrom.errors.required)||(null==r.newReportForm.controls.reportType||null==r.newReportForm.controls.reportType.errors?null:r.newReportForm.controls.reportType.errors.required))}}const _=[{path:"",component:(()=>{class e{constructor(e,t,r,n,o,a){this.dataStorage=e,this.apiService=t,this.formBuilder=r,this.sweetAlertService=n,this.datepipe=o,this.spinner=a,this.report=new l.a,this.paymentMethod=new p.a,this.reportTypeList=[{name:"COLLECTION REPORT",filename:"Collection_Report"},{name:"VAT SUMMARY",filename:"VAT_TAX_Summary"},{name:"TAX SUMMARY",filename:"VAT_TAX_Summary"},{name:"REPORT PER COMPANY",filename:"Per_Company"},{name:"REPORT PER AGENCY",filename:"Per_Agency"},{name:"REPORT PER SCREENER",filename:"Per_Screener"},{name:"REPORT PER MEDIUM",filename:"Per_Type_Of_Medium"},{name:"REPORT PER APPLICANT",filename:"Per_Applicant"}],this.applicants=[],this.screeners=[],this.newReportTypeList=[{name:"Application Per Decision",filename:"Application_Per_Decision"},{name:"Screeners Productivity",filename:"Screeners_Productivity"},{name:"Ad Specialists-Encoders",filename:"Ad_Specialists-Encoders"},{name:"Top 20 Agencies",filename:"Top_20_Agencies"},{name:"Top 20 Categories(by Decision)",filename:"Top_20_Categories(by_Decision)"},{name:"Top 5 Categories Disapproval",filename:"Top_5_Categories_Disapproval"},{name:"Top 5 Agencies Disapproval",filename:"Top_5_Agencies_Disapproval"},{name:"Decision Per Type of medium",filename:"Decision_per_type_of_medium"},{name:"Top 20 Clients(with Medium)",filename:"Top_20_Clients(with_Medium)"},{name:"Top 20 Categories(with Medium)",filename:"Top_20_Categories(with_Medium)"},{name:"Top 20 Clients",filename:"Top_20_Clients"},{name:"Top 20 Agencies(with client)",filename:"Top_20_Agencies(with_client)"}],this.paymentTypeList=[],this.activeCompanyList=[],this.isPaymentTypeRequired=!0,this.paymentTypeAll={id:0,paymentDescription:"All"}}ngOnInit(){this.currentUser=this.dataStorage.getUserAccount(),this.setFormValidator(),this.getPaymentType(),this.getActiveCompanies(),console.log(this.currentUser.userRole.name),this.getApplicants(),this.getScreeners()}ngOnDestroy(){}getApplicants(){this.apiService.findAll(i.n.userAccountType+"/APPLICANT").subscribe(e=>{var t,r,n;this.applicants.push({name:"ALL",id:0}),(null===(t=null==e?void 0:e.responseData)||void 0===t?void 0:t.data)&&(null===(n=null===(r=null==e?void 0:e.responseData)||void 0===r?void 0:r.data)||void 0===n?void 0:n.length)&&e.responseData.data.filter(e=>{this.applicants.push({name:`${e.firstName} ${e.middleName} ${e.lastName}`,id:e.id}),console.log("applicants",this.applicants)})})}setFormValidator(){"ROLE_ACCOUNTING"===this.currentUser.userRole.name?this.reportForm=this.formBuilder.group({reportType:["",[a.H.required]],paymentType:[""],company:[""],applicant:[""],screener:[""],dateFrom:["",[a.H.required]],dateTo:["",[a.H.required]]}):this.newReportForm=this.formBuilder.group({reportType:["",[a.H.required]],dateFrom:["",[a.H.required]],dateTo:["",[a.H.required]]})}getPaymentType(){this.apiService.findAll(i.n.paymentType).subscribe(e=>{this.paymentTypeList=e.responseData.data,this.paymentTypeList.push(this.paymentTypeAll)})}getScreeners(){this.apiService.findAll(i.n.userAccount+"/8").subscribe(e=>{var t,r,n;this.screeners.push({name:"ALL",id:0}),(null===(t=null==e?void 0:e.responseData)||void 0===t?void 0:t.data)&&(null===(n=null===(r=null==e?void 0:e.responseData)||void 0===r?void 0:r.data)||void 0===n?void 0:n.length)&&e.responseData.data.filter(e=>{this.screeners.push({name:`${e.firstName} ${e.middleName} ${e.lastName}`,id:e.id}),console.log("applicants",this.applicants)})})}getActiveCompanies(){this.apiService.findAll(i.n.activeCompanies).subscribe(e=>{this.activeCompanyList=e.responseData.data,this.activeCompanyList.push({id:0,companyName:"All"}),this.activeCompanyList.sort((e,t)=>e.id-t.id),console.log("companies => ",this.activeCompanyList)})}setReportType(e){"ROLE_ACCOUNTING"===this.currentUser.userRole.name?(this.selectedReportType=e.name,"Collection Report"===this.selectedReportType?this.isPaymentTypeRequired=!1:(this.reportForm.get("paymentType").reset(),this.isPaymentTypeRequired=!0)):this.selectedReportType=e,console.log("selected ReportType : ",this.selectedReportType)}setPaymentType(e){this.isPaymentTypeRequired=!0,this.selectedPaymentType=e}generateReport(){if(this.spinner.show(),this.report.format="xlsx",console.log("selected ",this.selectedReportType),"ROLE_ACCOUNTING"===this.currentUser.userRole.name){this.report.filename="VAT_TAX_Summary",this.report.module="Report",this.report.params={dateFrom:""+this.datepipe.transform(this.reportForm.get("dateFrom").value,"MM/dd/yyyy").toString(),dateTo:""+this.datepipe.transform(this.reportForm.get("dateTo").value,"MM/dd/yyyy"),reportType:this.reportType.filename};let e=i.n.validateReportsCollection+`/date-from/${this.datepipe.transform(this.reportForm.get("dateFrom").value,"yyyy-MM-dd").toString()}/date-to/${this.datepipe.transform(this.reportForm.get("dateTo").value,"yyyy-MM-dd").toString()}`;"Collection Report"===this.selectedReportType?(this.report.filename="Collection_Report",e=i.n.validateReportsCollection+`/date-from/${this.datepipe.transform(this.reportForm.get("dateFrom").value,"yyyy-MM-dd").toString()}/date-to/${this.datepipe.transform(this.reportForm.get("dateTo").value,"yyyy-MM-dd").toString()}/payment-type-id/${this.selectedPaymentType}`,this.report.params={dateFrom:""+this.datepipe.transform(this.reportForm.get("dateFrom").value,"MM/dd/yyyy").toString(),dateTo:""+this.datepipe.transform(this.reportForm.get("dateTo").value,"MM/dd/yyyy"),paymentTypeId:this.selectedPaymentType}):"REPORT PER COMPANY"===this.selectedReportType?(this.report.filename="Per_Company",e=i.n.validateReportsCollection+`/date-from/${this.datepipe.transform(this.reportForm.get("dateFrom").value,"yyyy-MM-dd").toString()}/date-to/${this.datepipe.transform(this.reportForm.get("dateTo").value,"yyyy-MM-dd").toString()}/payment-type-id/${this.selectedPaymentType}`,this.report.params={companyId:this.reportForm.get("company").value,dateFrom:""+this.datepipe.transform(this.reportForm.get("dateFrom").value,"MM/dd/yyyy").toString(),dateTo:""+this.datepipe.transform(this.reportForm.get("dateTo").value,"MM/dd/yyyy"),paymentTypeId:this.selectedPaymentType}):"REPORT PER AGENCY"===this.selectedReportType?(this.report.filename="Per_Agency",e=i.n.validateReportsCollection+`/date-from/${this.datepipe.transform(this.reportForm.get("dateFrom").value,"yyyy-MM-dd").toString()}/date-to/${this.datepipe.transform(this.reportForm.get("dateTo").value,"yyyy-MM-dd").toString()}/payment-type-id/${this.selectedPaymentType}`,this.report.params={agencyId:0,dateFrom:""+this.datepipe.transform(this.reportForm.get("dateFrom").value,"MM/dd/yyyy").toString(),dateTo:""+this.datepipe.transform(this.reportForm.get("dateTo").value,"MM/dd/yyyy"),paymentTypeId:this.selectedPaymentType}):"REPORT PER SCREENER"===this.selectedReportType?(this.report.filename="Per_Screener",e=i.n.validateReportsCollection+`/date-from/${this.datepipe.transform(this.reportForm.get("dateFrom").value,"yyyy-MM-dd").toString()}/date-to/${this.datepipe.transform(this.reportForm.get("dateTo").value,"yyyy-MM-dd").toString()}/payment-type-id/${this.selectedPaymentType}`,this.report.params={screenerId:this.reportForm.get("screener").value,dateFrom:""+this.datepipe.transform(this.reportForm.get("dateFrom").value,"MM/dd/yyyy").toString(),dateTo:""+this.datepipe.transform(this.reportForm.get("dateTo").value,"MM/dd/yyyy"),paymentTypeId:this.selectedPaymentType}):"REPORT PER APPLICANT"===this.selectedReportType?(this.report.filename="Per_Applicant",e=i.n.validateReportsCollection+`/date-from/${this.datepipe.transform(this.reportForm.get("dateFrom").value,"yyyy-MM-dd").toString()}/date-to/${this.datepipe.transform(this.reportForm.get("dateTo").value,"yyyy-MM-dd").toString()}/payment-type-id/${this.selectedPaymentType}`,this.report.params={applicantId:this.reportForm.get("applicant").value,dateFrom:""+this.datepipe.transform(this.reportForm.get("dateFrom").value,"MM/dd/yyyy").toString(),dateTo:""+this.datepipe.transform(this.reportForm.get("dateTo").value,"MM/dd/yyyy"),paymentTypeId:this.selectedPaymentType}):"VAT Summary"===this.selectedReportType?this.report.params={dateFrom:""+this.datepipe.transform(this.reportForm.get("dateFrom").value,"MM/dd/yyyy").toString(),dateTo:""+this.datepipe.transform(this.reportForm.get("dateTo").value,"MM/dd/yyyy"),reportType:"vat"}:"TAX Summary"===this.selectedReportType&&(this.report.params={dateFrom:""+this.datepipe.transform(this.reportForm.get("dateFrom").value,"MM/dd/yyyy").toString(),dateTo:""+this.datepipe.transform(this.reportForm.get("dateTo").value,"MM/dd/yyyy"),reportType:"wtax"}),this.apiService.findAll(e).subscribe(e=>{e.length>0?(console.log("REPORT LENGTH",e.length),this.printReport(this.report)):(this.sweetAlertService.customErrorMessage("No Record found on date ranged"),this.spinner.hide())})}else{this.report.filename=this.selectedReportType,console.log("newform ",this.newReportForm);let e=""+this.datepipe.transform(this.newReportForm.get("dateFrom").value,"MM/dd/yyyy").toString(),t=""+this.datepipe.transform(this.newReportForm.get("dateTo").value,"MM/dd/yyyy");this.report.module="AppData",this.report.params={dateFrom:e,dateTo:t},this.printReport(this.report)}}printReport(e){this.apiService.printReport(i.n.generateReports,e).subscribe(e=>{const t=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),r=URL.createObjectURL(t);var n=document.createElement("a");n.download=this.selectedReportType+".xlsx",n.href=r,n.click(),"ROLE_ACCOUNTING"===this.currentUser.userRole.name?this.reportForm.reset():this.newReportForm.reset(),this.selectedReportType=null,this.sweetAlertService.customSuccessMessage("Successfully Generated!"),this.spinner.hide()},e=>{this.spinner.hide(),this.sweetAlertService.customErrorMessage("No Record found on date ranged")})}}return e.\u0275fac=function(t){return new(t||e)(m["\u0275\u0275directiveInject"](s.c),m["\u0275\u0275directiveInject"](s.b),m["\u0275\u0275directiveInject"](a.g),m["\u0275\u0275directiveInject"](s.e),m["\u0275\u0275directiveInject"](n.f),m["\u0275\u0275directiveInject"](d.c))},e.\u0275cmp=m["\u0275\u0275defineComponent"]({type:e,selectors:[["app-reports"]],decls:9,vars:2,consts:[[1,"container-fluid"],[1,"row"],[1,"col-md-12","title"],[4,"ngIf"],[3,"formGroup"],["appearance","outline",1,"col-md-6"],["matInput","","placeholder","Date","readonly","","name","dateFrom","readonly","","formControlName","dateFrom",3,"matDatepicker","ngModel","ngModelChange"],["matSuffix","",3,"for"],["color","warn","disabled","false"],["dateFrom",""],["matInput","","placeholder","Date","readonly","","name","dateTo","formControlName","dateTo",3,"matDatepicker","ngModel","ngModelChange"],["Date",""],["name","reportType","formControlName","reportType",3,"ngModel","ngModelChange"],[3,"value","click",4,"ngFor","ngForOf"],["class","col-md-6","appearance","outline",4,"ngIf"],[1,"col-md-9"],[1,"col-md-3"],["mat-raised-button","",1,"button-red",3,"disabled","click"],[1,"material-icons","color__white"],[3,"value","click"],["name","paymentType","formControlName","paymentType",3,"ngModel","ngModelChange"],["name","company","formControlName","company"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["name","applicant","formControlName","applicant"],["name","company","formControlName","screener"]],template:function(e,t){1&e&&(m["\u0275\u0275elementStart"](0,"form"),m["\u0275\u0275elementStart"](1,"div",0),m["\u0275\u0275elementStart"](2,"div",1),m["\u0275\u0275elementStart"](3,"div",2),m["\u0275\u0275elementStart"](4,"mat-label"),m["\u0275\u0275text"](5," Reports "),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"](),m["\u0275\u0275element"](6,"hr"),m["\u0275\u0275template"](7,A,36,14,"div",3),m["\u0275\u0275template"](8,w,31,10,"div",3),m["\u0275\u0275elementEnd"](),m["\u0275\u0275elementEnd"]()),2&e&&(m["\u0275\u0275advance"](7),m["\u0275\u0275property"]("ngIf","ROLE_ACCOUNTING"===t.currentUser.userRole.name),m["\u0275\u0275advance"](1),m["\u0275\u0275property"]("ngIf","ROLE_SUPER_ADMIN"===t.currentUser.userRole.name||"ROLE_ADMIN"===t.currentUser.userRole.name))},directives:[a.J,a.u,a.v,c.g,n.t,a.l,c.c,y.b,a.d,u.h,a.t,a.j,u.j,c.j,u.f,f.a,n.s,h.b,T.m],styles:[""]}),e})()}];let O=(()=>{class e{}return e.\u0275mod=m["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=m["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[o.f.forChild(_)],o.f]}),e})();var N=r("tk/3");let I=(()=>{class e{}return e.\u0275mod=m["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=m["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[n.c,O,N.b,a.D,i.k]]}),e})()},za27:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{}}}]);