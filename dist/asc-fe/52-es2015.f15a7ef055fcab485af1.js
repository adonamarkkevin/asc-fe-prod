(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{O0vE:function(e,t,n){"use strict";n.r(t),n.d(t,"CompanyVoucherFundModule",(function(){return O}));var r=n("ofXK"),a=n("tyNb"),o=n("3Pt+"),i=n("+0xr"),s=n("3swC"),l=n("sKXY"),c=n("M0ag");class m{}var u=n("Inok"),d=n("PSD3"),h=n.n(d),p=n("fXoL"),f=n("dJ3e"),v=n("jhN1"),g=n("TMp0"),y=n("nBem"),S=n("kmnG"),C=n("NFeN"),R=n("DeKZ"),b=n("qFsG"),E=n("bTqV"),w=n("d3UM"),x=n("FKr1");function D(e,t){if(1&e&&(p["\u0275\u0275elementStart"](0,"div"),p["\u0275\u0275elementStart"](1,"div",24),p["\u0275\u0275elementStart"](2,"object",25),p["\u0275\u0275elementStart"](3,"iframe",26),p["\u0275\u0275elementStart"](4,"p"),p["\u0275\u0275text"](5,"This browser does not support PDF!"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()),2&e){const e=p["\u0275\u0275nextContext"](2);p["\u0275\u0275advance"](2),p["\u0275\u0275property"]("data",e.safeURL,p["\u0275\u0275sanitizeResourceUrl"]),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("src",e.safeURL,p["\u0275\u0275sanitizeResourceUrl"])}}function V(e,t){if(1&e){const e=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementStart"](0,"mat-option",30),p["\u0275\u0275listener"]("click",(function(){p["\u0275\u0275restoreView"](e);const n=t.$implicit;return p["\u0275\u0275nextContext"](3).getCompanyDetails(n)})),p["\u0275\u0275text"](1),p["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;p["\u0275\u0275property"]("value",e),p["\u0275\u0275advance"](1),p["\u0275\u0275textInterpolate1"](" ",e.companyName," ")}}function L(e,t){if(1&e){const e=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementStart"](0,"mat-form-field",27),p["\u0275\u0275elementStart"](1,"mat-label"),p["\u0275\u0275text"](2," Company Name "),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](3,"mat-select",28),p["\u0275\u0275listener"]("ngModelChange",(function(t){return p["\u0275\u0275restoreView"](e),p["\u0275\u0275nextContext"](2).voucherReplenishment.company=t})),p["\u0275\u0275template"](4,V,2,2,"mat-option",29),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()}if(2&e){const e=p["\u0275\u0275nextContext"](2);p["\u0275\u0275advance"](3),p["\u0275\u0275property"]("ngModel",e.voucherReplenishment.company),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngForOf",e.companyList)}}function I(e,t){if(1&e&&(p["\u0275\u0275elementStart"](0,"mat-form-field",27),p["\u0275\u0275elementStart"](1,"mat-label"),p["\u0275\u0275text"](2,"Company Name"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275element"](3,"input",31),p["\u0275\u0275elementEnd"]()),2&e){const e=p["\u0275\u0275nextContext"](2);p["\u0275\u0275advance"](3),p["\u0275\u0275property"]("value",e.company.companyName)}}function F(e,t){if(1&e&&(p["\u0275\u0275elementStart"](0,"mat-form-field",16),p["\u0275\u0275elementStart"](1,"mat-label"),p["\u0275\u0275text"](2,"Remaining Voucher Balance "),p["\u0275\u0275elementEnd"](),p["\u0275\u0275element"](3,"input",32),p["\u0275\u0275elementEnd"]()),2&e){const e=p["\u0275\u0275nextContext"](2);p["\u0275\u0275advance"](3),p["\u0275\u0275property"]("value",e.remainingVoucherBalance)}}const A=function(){return{standalone:!0}};function T(e,t){if(1&e){const e=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementStart"](0,"div",0),p["\u0275\u0275elementStart"](1,"div",1),p["\u0275\u0275elementStart"](2,"div",7),p["\u0275\u0275elementStart"](3,"mat-label"),p["\u0275\u0275text"](4," Company Information "),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275element"](5,"hr"),p["\u0275\u0275element"](6,"br"),p["\u0275\u0275elementStart"](7,"div",8),p["\u0275\u0275elementStart"](8,"div",9),p["\u0275\u0275elementStart"](9,"div"),p["\u0275\u0275elementStart"](10,"mat-label"),p["\u0275\u0275text"](11,"Voucher: \xa0\xa0\xa0"),p["\u0275\u0275elementStart"](12,"span"),p["\u0275\u0275text"](13,"PDF file only!"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275element"](14,"br"),p["\u0275\u0275elementStart"](15,"input",10),p["\u0275\u0275listener"]("ngModelChange",(function(t){return p["\u0275\u0275restoreView"](e),p["\u0275\u0275nextContext"]().attachment=t}))("change",(function(t){return p["\u0275\u0275restoreView"](e),p["\u0275\u0275nextContext"]().selectFile(t)})),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275template"](16,D,6,2,"div",11),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](17,"div",12),p["\u0275\u0275elementStart"](18,"form",13),p["\u0275\u0275elementStart"](19,"div",1),p["\u0275\u0275template"](20,L,5,2,"mat-form-field",14),p["\u0275\u0275template"](21,I,4,1,"mat-form-field",14),p["\u0275\u0275template"](22,F,4,1,"mat-form-field",15),p["\u0275\u0275elementStart"](23,"mat-form-field",16),p["\u0275\u0275elementStart"](24,"mat-label"),p["\u0275\u0275text"](25,"Amount Transferred "),p["\u0275\u0275elementStart"](26,"span",17),p["\u0275\u0275text"](27,"*"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](28,"input",18),p["\u0275\u0275listener"]("ngModelChange",(function(t){return p["\u0275\u0275restoreView"](e),p["\u0275\u0275nextContext"]().voucherReplenishment.amountTransfered=t})),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](29,"div",1),p["\u0275\u0275element"](30,"div",19),p["\u0275\u0275elementStart"](31,"div",20),p["\u0275\u0275elementStart"](32,"button",21),p["\u0275\u0275listener"]("click",(function(){return p["\u0275\u0275restoreView"](e),p["\u0275\u0275nextContext"]().uploadVoucher()})),p["\u0275\u0275elementStart"](33,"i",22),p["\u0275\u0275text"](34,"task_alt"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275text"](35," SUBMIT "),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275element"](36,"br"),p["\u0275\u0275element"](37,"br"),p["\u0275\u0275element"](38,"hr"),p["\u0275\u0275element"](39,"br"),p["\u0275\u0275element"](40,"app-form-list",23),p["\u0275\u0275element"](41,"br"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()}if(2&e){const e=p["\u0275\u0275nextContext"]();p["\u0275\u0275advance"](15),p["\u0275\u0275property"]("ngModel",e.attachment)("ngModelOptions",p["\u0275\u0275pureFunction0"](11,A)),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",e.attachment),p["\u0275\u0275advance"](2),p["\u0275\u0275property"]("formGroup",e.voucherReplenishmentForm),p["\u0275\u0275advance"](2),p["\u0275\u0275property"]("ngIf","save"===e.process),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf","update"===e.process),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf","update"===e.process),p["\u0275\u0275advance"](6),p["\u0275\u0275property"]("ngModel",e.voucherReplenishment.amountTransfered),p["\u0275\u0275advance"](4),p["\u0275\u0275property"]("disabled",!e.attachment||!(null!=e.voucherReplenishment&&e.voucherReplenishment.amountTransfered)),p["\u0275\u0275advance"](8),p["\u0275\u0275property"]("dataSource",e.dataSourceReplenishments)("displayedColumns",e.displayedReplenishmentColumns)}}const U=[{path:"",component:(()=>{class e{constructor(e,t,n,r,a,o,i){this.formBuilder=e,this.router=t,this.apiService=n,this.sweetAlertService=r,this.sanitizer=a,this.fileStorageService=o,this.dataStorage=i,this.displayedColumns=["company","fundAmount","voucherDate"],this.displayedReplenishmentColumns=["transferedDate","amountTransfered","status"],this.voucherReplenishment=new m,this.voucher=new u.a,this.company=new l.k,this.voucherReplenishmentList=[],this.companyList=[],this.statusList=[...c.B],this.currentDate=new Date,this.previewDocument=!1,this.process="save",this.remainingVoucherBalance=0}ngOnInit(){this.currentUser=this.dataStorage.getUserAccount(),this.setFormValidator(),this.getCompanyList(),this.getVoucherTrasnferList()}ngOnDestroy(){}setFormValidator(){this.voucherReplenishment.status=c.m.ACTIVE,this.voucherReplenishmentForm=this.formBuilder.group({amountTransfered:["",[o.H.required]],company:["",[o.H.required]],transferedDate:["",[o.H.required]]})}resetFormValidator(){this.voucherReplenishment=new m,this.voucherReplenishment.status=c.m.ACTIVE,this.voucherReplenishmentForm.markAsUntouched(),this.voucherReplenishmentForm.markAsPristine()}getCompanyList(){this.apiService.findAll(c.n.company).subscribe(e=>{this.companyList=e.responseData.data})}getCompanyDetails(e){this.company=e}getVoucherTrasnferDetails(){this.process="update",this.apiService.findById(c.n.voucher,this.formListComponent.idForUpdate).subscribe(e=>{e&&(this.company=e.responseData.data.company,this.voucher.voucherAttachmentReference=e.responseData.data.voucherAttachmentReference,this.voucherReplenishment.company=this.company,this.remainingVoucherBalance=e.responseData.data.fundAmount,this.voucherReplenishment.transferedDate=e.responseData.data.voucherDate,this.voucherReplenishment.status=e.responseData.data.status,this.getVoucherTrasnferList(),this.viewAttachmentFile(),this.getCompanyReplenishmentList(),this.previewDocument=!0)})}viewAttachmentFile(){this.apiService.findByParam(c.n.attachmentDocument,"voucher-attachment-reference/"+this.voucher.voucherAttachmentReference).subscribe(e=>{e&&(this.attachmentDocument=e.responseData.data,this.safeURL=this.sanitizer.bypassSecurityTrustResourceUrl(this.attachmentDocument.fileURL))},e=>{this.attachmentDocument=[]})}getVoucherTrasnferList(){this.apiService.findAll(c.n.voucher).subscribe(e=>{this.dataSource=new i.p(e.responseData.data),this.dataSource.paginator=this.formListComponent.paginator,this.dataSource.sort=this.formListComponent.sort})}getCompanyReplenishmentList(){var e;this.apiService.findAll(c.n.voucherReplenishmentsByCompany+(null===(e=this.company)||void 0===e?void 0:e.id)).subscribe(e=>{this.dataSourceReplenishments=new i.p(e.responseData.data),this.dataSourceReplenishments.paginator=this.formListComponent.paginator,this.dataSourceReplenishments.sort=this.formListComponent.sort})}selectFile(e){const t=e.target.files[0].size;if("application/pdf"!==e.target.files[0].type)return this.sweetAlertService.customErrorMessage("Attachment should be in PDF format only."),void(e.target.value="");if(t>15e6)return this.sweetAlertService.customErrorMessage("Attachments' total file size should not exceed 15MB."),void(e.target.value="");{const t=URL.createObjectURL(e.target.files[0]);this.safeURL=this.sanitizer.bypassSecurityTrustResourceUrl(t),this.previewDocument=!0;const n=new FileReader,[r]=e.target.files;n.readAsDataURL(r),n.onload=()=>{}}this.selectedFiles=e.target.files}uploadVoucher(){h.a.fire({text:"Are you sure you want to submit this VOUCHER?",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Confirm"}).then(e=>{if(e.value)if("update"===this.process)this.saveVoucherReplenishment();else{this.dataStorage.setDisplayProgressbar(!0);let e="";e="?&attachmentType="+c.j.VOUCHER_FUND+"&submissionType="+c.C.ORIGINAL,this.fileStorageService.pushFileToStorage(c.n.attachmentDocument,this.selectedFiles.item(0),e).subscribe(e=>{this.voucherReplenishment.voucherAttachmentReference=e.responseData.data.voucherAttachmentReference,this.voucherReplenishment.company=this.company,console.log("VOUCHER REPLENISHMENT",this.voucherReplenishment),this.saveVoucherReplenishment(),this.selectedFiles=void 0},e=>{this.sweetAlertService.error(e)},()=>{this.dataStorage.setDisplayProgressbar(!1)})}})}saveVoucherReplenishment(){this.apiService.save(c.n.accountingVoucherFundTransfer,this.voucherReplenishment).subscribe(e=>{console.log(e),this.sweetAlertService.success(e),this.setFormValidator(),this.getVoucherTrasnferList(),this.resetFormValidator(),this.process="save",this.previewDocument=!1,this.attachment=null,this.router.navigateByUrl("asc/page/accounting/voucher-replenishment")},e=>{console.log(e),this.sweetAlertService.error(e)})}compareStatus(e,t){if(e&&t)return e===t}}return e.\u0275fac=function(t){return new(t||e)(p["\u0275\u0275directiveInject"](o.g),p["\u0275\u0275directiveInject"](a.b),p["\u0275\u0275directiveInject"](f.b),p["\u0275\u0275directiveInject"](f.e),p["\u0275\u0275directiveInject"](v.b),p["\u0275\u0275directiveInject"](g.a),p["\u0275\u0275directiveInject"](y.a))},e.\u0275cmp=p["\u0275\u0275defineComponent"]({type:e,selectors:[["app-company-voucher-fund"]],viewQuery:function(e,t){var n;1&e&&p["\u0275\u0275viewQuery"](s.a,!0),2&e&&p["\u0275\u0275queryRefresh"](n=p["\u0275\u0275loadQuery"]())&&(t.formListComponent=n.first)},inputs:{safeURL:"safeURL"},decls:18,vars:3,consts:[[1,"container-fluid"],[1,"row"],[1,"col-md-12","title"],[1,"col-md-12"],[1,"material-icons"],[3,"dataSource","displayedColumns","selectInListFunction"],["class","container-fluid",4,"ngIf"],[1,"col-md-12","information-title"],[1,"row","col-md-12"],[1,"row","col-md-5"],["type","file","accept",".pdf",1,"file-upload",3,"ngModel","ngModelOptions","ngModelChange","change"],[4,"ngIf"],[1,"row","col-md-7"],[3,"formGroup"],["class","col-md-12","appearance","outline",4,"ngIf"],["class","col-md-6","appearance","outline",4,"ngIf"],["appearance","outline",1,"col-md-6"],[1,"required-field"],["matInput","","name","amountTransfered","formControlName","amountTransfered","type","number",3,"ngModel","ngModelChange"],[1,"col-md-10"],[1,"col-md-2"],["mat-raised-button","",1,"button-red",3,"disabled","click"],[1,"material-icons","color__white"],[3,"dataSource","displayedColumns"],[1,"file-upload"],["type","application/pdf","width","100%","height","500",3,"data"],["width","100%","height","500",3,"src"],["appearance","outline",1,"col-md-12"],["name","company","formControlName","company",3,"ngModel","ngModelChange"],[3,"value","click",4,"ngFor","ngForOf"],[3,"value","click"],["matInput","","readonly","",3,"value"],["matInput","","name","remainingVoucherBalance","formControlName","remainingVoucherBalance","type","number","readonly","",3,"value"]],template:function(e,t){1&e&&(p["\u0275\u0275elementStart"](0,"form"),p["\u0275\u0275elementStart"](1,"div",0),p["\u0275\u0275elementStart"](2,"div",1),p["\u0275\u0275elementStart"](3,"div",2),p["\u0275\u0275elementStart"](4,"mat-label"),p["\u0275\u0275elementStart"](5,"mat-icon"),p["\u0275\u0275text"](6,"view_list"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275text"](7," Voucher Replenishment "),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275element"](8,"hr"),p["\u0275\u0275elementStart"](9,"div",3),p["\u0275\u0275elementStart"](10,"b"),p["\u0275\u0275elementStart"](11,"b",4),p["\u0275\u0275text"](12,"error_outline"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275text"](13," Note: Select enrolled voucher to add fund or view amount replenishments made."),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275element"](14,"br"),p["\u0275\u0275elementStart"](15,"app-form-list",5),p["\u0275\u0275listener"]("selectInListFunction",(function(){return t.getVoucherTrasnferDetails()})),p["\u0275\u0275elementEnd"](),p["\u0275\u0275element"](16,"br"),p["\u0275\u0275template"](17,T,42,12,"div",6),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()),2&e&&(p["\u0275\u0275advance"](15),p["\u0275\u0275property"]("dataSource",t.dataSource)("displayedColumns",t.displayedColumns),p["\u0275\u0275advance"](2),p["\u0275\u0275property"]("ngIf","ROLE_APPLICANT"===(null==t.currentUser?null:t.currentUser.userRole.name)||"ROLE_ACCOUNTING"===(null==t.currentUser?null:t.currentUser.userRole.name)&&!0===t.previewDocument))},directives:[o.J,o.u,o.v,S.g,C.a,R.a,r.t,o.d,o.t,o.w,o.l,S.c,b.b,o.z,o.j,E.b,w.a,r.s,x.m],styles:[".button-green[_ngcontent-%COMP%]{background-color:green;color:#fff}.information-title[_ngcontent-%COMP%]{text-align:center;font-weight:700;font-size:24px}"]}),e})()}];let M=(()=>{class e{}return e.\u0275mod=p["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=p["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[a.f.forChild(U)],a.f]}),e})();var N=n("tk/3"),B=n("7Tf7");let O=(()=>{class e{}return e.\u0275mod=p["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=p["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[r.c,M,N.b,o.D,o.n,c.k,B.a]]}),e})()}}]);