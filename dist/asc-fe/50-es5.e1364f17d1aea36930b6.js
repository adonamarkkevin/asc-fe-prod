!function(){function e(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var r,a,o=[],i=!0,l=!1;try{for(n=n.call(e);!(i=(r=n.next()).done)&&(o.push(r.value),!t||o.length!==t);i=!0);}catch(s){l=!0,a=s}finally{try{i||null==n.return||n.return()}finally{if(l)throw a}}return o}(e,t)||n(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||n(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{O0vE:function(n,r,a){"use strict";a.r(r),a.d(r,"CompanyVoucherFundModule",(function(){return H}));var l=a("ofXK"),s=a("tyNb"),c=a("3Pt+"),m=a("+0xr"),u=a("3swC"),d=a("sKXY"),p=a("M0ag"),f=o((function e(){i(this,e)})),h=a("Inok"),v=a("PSD3"),y=a.n(v),g=a("fXoL"),S=a("dJ3e"),b=a("jhN1"),C=a("TMp0"),w=a("nBem"),R=a("kmnG"),E=a("NFeN"),x=a("DeKZ"),A=a("qFsG"),D=a("bTqV"),I=a("d3UM"),V=a("FKr1");function L(e,t){if(1&e&&(g["\u0275\u0275elementStart"](0,"div"),g["\u0275\u0275elementStart"](1,"div",24),g["\u0275\u0275elementStart"](2,"object",25),g["\u0275\u0275elementStart"](3,"iframe",26),g["\u0275\u0275elementStart"](4,"p"),g["\u0275\u0275text"](5,"This browser does not support PDF!"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"]()),2&e){var n=g["\u0275\u0275nextContext"](2);g["\u0275\u0275advance"](2),g["\u0275\u0275property"]("data",n.safeURL,g["\u0275\u0275sanitizeResourceUrl"]),g["\u0275\u0275advance"](1),g["\u0275\u0275property"]("src",n.safeURL,g["\u0275\u0275sanitizeResourceUrl"])}}function F(e,t){if(1&e){var n=g["\u0275\u0275getCurrentView"]();g["\u0275\u0275elementStart"](0,"mat-option",30),g["\u0275\u0275listener"]("click",(function(){g["\u0275\u0275restoreView"](n);var e=t.$implicit;return g["\u0275\u0275nextContext"](3).getCompanyDetails(e)})),g["\u0275\u0275text"](1),g["\u0275\u0275elementEnd"]()}if(2&e){var r=t.$implicit;g["\u0275\u0275property"]("value",r),g["\u0275\u0275advance"](1),g["\u0275\u0275textInterpolate1"](" ",r.companyName," ")}}function T(e,t){if(1&e){var n=g["\u0275\u0275getCurrentView"]();g["\u0275\u0275elementStart"](0,"mat-form-field",27),g["\u0275\u0275elementStart"](1,"mat-label"),g["\u0275\u0275text"](2," Company Name "),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](3,"mat-select",28),g["\u0275\u0275listener"]("ngModelChange",(function(e){return g["\u0275\u0275restoreView"](n),g["\u0275\u0275nextContext"](2).voucherReplenishment.company=e})),g["\u0275\u0275template"](4,F,2,2,"mat-option",29),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"]()}if(2&e){var r=g["\u0275\u0275nextContext"](2);g["\u0275\u0275advance"](3),g["\u0275\u0275property"]("ngModel",r.voucherReplenishment.company),g["\u0275\u0275advance"](1),g["\u0275\u0275property"]("ngForOf",r.companyList)}}function k(e,t){if(1&e&&(g["\u0275\u0275elementStart"](0,"mat-form-field",27),g["\u0275\u0275elementStart"](1,"mat-label"),g["\u0275\u0275text"](2,"Company Name"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275element"](3,"input",31),g["\u0275\u0275elementEnd"]()),2&e){var n=g["\u0275\u0275nextContext"](2);g["\u0275\u0275advance"](3),g["\u0275\u0275property"]("value",n.company.companyName)}}function U(e,t){if(1&e&&(g["\u0275\u0275elementStart"](0,"mat-form-field",16),g["\u0275\u0275elementStart"](1,"mat-label"),g["\u0275\u0275text"](2,"Remaining Voucher Balance "),g["\u0275\u0275elementEnd"](),g["\u0275\u0275element"](3,"input",32),g["\u0275\u0275elementEnd"]()),2&e){var n=g["\u0275\u0275nextContext"](2);g["\u0275\u0275advance"](3),g["\u0275\u0275property"]("value",n.remainingVoucherBalance)}}var M=function(){return{standalone:!0}};function j(e,t){if(1&e){var n=g["\u0275\u0275getCurrentView"]();g["\u0275\u0275elementStart"](0,"div",0),g["\u0275\u0275elementStart"](1,"div",1),g["\u0275\u0275elementStart"](2,"div",7),g["\u0275\u0275elementStart"](3,"mat-label"),g["\u0275\u0275text"](4," Company Information "),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275element"](5,"hr"),g["\u0275\u0275element"](6,"br"),g["\u0275\u0275elementStart"](7,"div",8),g["\u0275\u0275elementStart"](8,"div",9),g["\u0275\u0275elementStart"](9,"div"),g["\u0275\u0275elementStart"](10,"mat-label"),g["\u0275\u0275text"](11,"Voucher: \xa0\xa0\xa0"),g["\u0275\u0275elementStart"](12,"span"),g["\u0275\u0275text"](13,"PDF file only!"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275element"](14,"br"),g["\u0275\u0275elementStart"](15,"input",10),g["\u0275\u0275listener"]("ngModelChange",(function(e){return g["\u0275\u0275restoreView"](n),g["\u0275\u0275nextContext"]().attachment=e}))("change",(function(e){return g["\u0275\u0275restoreView"](n),g["\u0275\u0275nextContext"]().selectFile(e)})),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275template"](16,L,6,2,"div",11),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](17,"div",12),g["\u0275\u0275elementStart"](18,"form",13),g["\u0275\u0275elementStart"](19,"div",1),g["\u0275\u0275template"](20,T,5,2,"mat-form-field",14),g["\u0275\u0275template"](21,k,4,1,"mat-form-field",14),g["\u0275\u0275template"](22,U,4,1,"mat-form-field",15),g["\u0275\u0275elementStart"](23,"mat-form-field",16),g["\u0275\u0275elementStart"](24,"mat-label"),g["\u0275\u0275text"](25,"Amount Transferred "),g["\u0275\u0275elementStart"](26,"span",17),g["\u0275\u0275text"](27,"*"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](28,"input",18),g["\u0275\u0275listener"]("ngModelChange",(function(e){return g["\u0275\u0275restoreView"](n),g["\u0275\u0275nextContext"]().voucherReplenishment.amountTransfered=e})),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementStart"](29,"div",1),g["\u0275\u0275element"](30,"div",19),g["\u0275\u0275elementStart"](31,"div",20),g["\u0275\u0275elementStart"](32,"button",21),g["\u0275\u0275listener"]("click",(function(){return g["\u0275\u0275restoreView"](n),g["\u0275\u0275nextContext"]().uploadVoucher()})),g["\u0275\u0275elementStart"](33,"i",22),g["\u0275\u0275text"](34,"task_alt"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275text"](35," SUBMIT "),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275element"](36,"br"),g["\u0275\u0275element"](37,"br"),g["\u0275\u0275element"](38,"hr"),g["\u0275\u0275element"](39,"br"),g["\u0275\u0275element"](40,"app-form-list",23),g["\u0275\u0275element"](41,"br"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"]()}if(2&e){var r=g["\u0275\u0275nextContext"]();g["\u0275\u0275advance"](15),g["\u0275\u0275property"]("ngModel",r.attachment)("ngModelOptions",g["\u0275\u0275pureFunction0"](11,M)),g["\u0275\u0275advance"](1),g["\u0275\u0275property"]("ngIf",r.attachment),g["\u0275\u0275advance"](2),g["\u0275\u0275property"]("formGroup",r.voucherReplenishmentForm),g["\u0275\u0275advance"](2),g["\u0275\u0275property"]("ngIf","save"===r.process),g["\u0275\u0275advance"](1),g["\u0275\u0275property"]("ngIf","update"===r.process),g["\u0275\u0275advance"](1),g["\u0275\u0275property"]("ngIf","update"===r.process),g["\u0275\u0275advance"](6),g["\u0275\u0275property"]("ngModel",r.voucherReplenishment.amountTransfered),g["\u0275\u0275advance"](4),g["\u0275\u0275property"]("disabled",!r.attachment||!(null!=r.voucherReplenishment&&r.voucherReplenishment.amountTransfered)),g["\u0275\u0275advance"](8),g["\u0275\u0275property"]("dataSource",r.dataSourceReplenishments)("displayedColumns",r.displayedReplenishmentColumns)}}var N,O,B,P=[{path:"",component:(N=function(){function n(e,r,a,o,l,s,c){i(this,n),this.formBuilder=e,this.router=r,this.apiService=a,this.sweetAlertService=o,this.sanitizer=l,this.fileStorageService=s,this.dataStorage=c,this.displayedColumns=["company","fundAmount","voucherDate"],this.displayedReplenishmentColumns=["transferedDate","amountTransfered","status"],this.voucherReplenishment=new f,this.voucher=new h.a,this.company=new d.k,this.voucherReplenishmentList=[],this.companyList=[],this.statusList=t(p.A),this.currentDate=new Date,this.previewDocument=!1,this.process="save",this.remainingVoucherBalance=0}return o(n,[{key:"ngOnInit",value:function(){this.currentUser=this.dataStorage.getUserAccount(),this.setFormValidator(),this.getCompanyList(),this.getVoucherTrasnferList()}},{key:"ngOnDestroy",value:function(){}},{key:"setFormValidator",value:function(){this.voucherReplenishment.status=p.m.ACTIVE,this.voucherReplenishmentForm=this.formBuilder.group({amountTransfered:["",[c.H.required]],company:["",[c.H.required]],transferedDate:["",[c.H.required]]})}},{key:"resetFormValidator",value:function(){this.voucherReplenishment=new f,this.voucherReplenishment.status=p.m.ACTIVE,this.voucherReplenishmentForm.markAsUntouched(),this.voucherReplenishmentForm.markAsPristine()}},{key:"getCompanyList",value:function(){var e=this;this.apiService.findAll(p.n.company).subscribe((function(t){e.companyList=t.responseData.data}))}},{key:"getCompanyDetails",value:function(e){this.company=e}},{key:"getVoucherTrasnferDetails",value:function(){var e=this;this.process="update",this.apiService.findById(p.n.voucher,this.formListComponent.idForUpdate).subscribe((function(t){t&&(e.company=t.responseData.data.company,e.voucher.voucherAttachmentReference=t.responseData.data.voucherAttachmentReference,e.voucherReplenishment.company=e.company,e.remainingVoucherBalance=t.responseData.data.fundAmount,e.voucherReplenishment.transferedDate=t.responseData.data.voucherDate,e.voucherReplenishment.status=t.responseData.data.status,e.getVoucherTrasnferList(),e.viewAttachmentFile(),e.getCompanyReplenishmentList(),e.previewDocument=!0)}))}},{key:"viewAttachmentFile",value:function(){var e=this;this.apiService.findByParam(p.n.attachmentDocument,"voucher-attachment-reference/"+this.voucher.voucherAttachmentReference).subscribe((function(t){t&&(e.attachmentDocument=t.responseData.data,e.safeURL=e.sanitizer.bypassSecurityTrustResourceUrl(e.attachmentDocument.fileURL))}),(function(t){e.attachmentDocument=[]}))}},{key:"getVoucherTrasnferList",value:function(){var e=this;this.apiService.findAll(p.n.voucher).subscribe((function(t){e.dataSource=new m.p(t.responseData.data),e.dataSource.paginator=e.formListComponent.paginator,e.dataSource.sort=e.formListComponent.sort}))}},{key:"getCompanyReplenishmentList",value:function(){var e,t=this;this.apiService.findAll(p.n.voucherReplenishmentsByCompany+(null===(e=this.company)||void 0===e?void 0:e.id)).subscribe((function(e){t.dataSourceReplenishments=new m.p(e.responseData.data),t.dataSourceReplenishments.paginator=t.formListComponent.paginator,t.dataSourceReplenishments.sort=t.formListComponent.sort}))}},{key:"selectFile",value:function(t){var n=t.target.files[0].size;if("application/pdf"!==t.target.files[0].type)return this.sweetAlertService.customErrorMessage("Attachment should be in PDF format only."),void(t.target.value="");if(n>15e6)return this.sweetAlertService.customErrorMessage("Attachments' total file size should not exceed 15MB."),void(t.target.value="");var r=URL.createObjectURL(t.target.files[0]);this.safeURL=this.sanitizer.bypassSecurityTrustResourceUrl(r),this.previewDocument=!0;var a=new FileReader,o=e(t.target.files,1)[0];a.readAsDataURL(o),a.onload=function(){},this.selectedFiles=t.target.files}},{key:"uploadVoucher",value:function(){var e=this;y.a.fire({text:"Are you sure you want to submit this VOUCHER?",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Confirm"}).then((function(t){if(t.value)if("update"===e.process)e.saveVoucherReplenishment();else{var n;e.dataStorage.setDisplayProgressbar(!0),n="?&attachmentType="+p.j.VOUCHER_FUND+"&submissionType="+p.B.ORIGINAL,e.fileStorageService.pushFileToStorage(p.n.attachmentDocument,e.selectedFiles.item(0),n).subscribe((function(t){e.voucherReplenishment.voucherAttachmentReference=t.responseData.data.voucherAttachmentReference,e.voucherReplenishment.company=e.company,console.log("VOUCHER REPLENISHMENT",e.voucherReplenishment),e.saveVoucherReplenishment(),e.selectedFiles=void 0}),(function(t){e.sweetAlertService.error(t)}),(function(){e.dataStorage.setDisplayProgressbar(!1)}))}}))}},{key:"saveVoucherReplenishment",value:function(){var e=this;this.apiService.save(p.n.accountingVoucherFundTransfer,this.voucherReplenishment).subscribe((function(t){console.log(t),e.sweetAlertService.success(t),e.setFormValidator(),e.getVoucherTrasnferList(),e.resetFormValidator(),e.process="save",e.previewDocument=!1,e.attachment=null,e.router.navigateByUrl("asc/page/accounting/voucher-replenishment")}),(function(t){console.log(t),e.sweetAlertService.error(t)}))}},{key:"compareStatus",value:function(e,t){if(e&&t)return e===t}}]),n}(),N.\u0275fac=function(e){return new(e||N)(g["\u0275\u0275directiveInject"](c.g),g["\u0275\u0275directiveInject"](s.b),g["\u0275\u0275directiveInject"](S.b),g["\u0275\u0275directiveInject"](S.e),g["\u0275\u0275directiveInject"](b.b),g["\u0275\u0275directiveInject"](C.a),g["\u0275\u0275directiveInject"](w.a))},N.\u0275cmp=g["\u0275\u0275defineComponent"]({type:N,selectors:[["app-company-voucher-fund"]],viewQuery:function(e,t){var n;1&e&&g["\u0275\u0275viewQuery"](u.a,!0),2&e&&g["\u0275\u0275queryRefresh"](n=g["\u0275\u0275loadQuery"]())&&(t.formListComponent=n.first)},inputs:{safeURL:"safeURL"},decls:18,vars:3,consts:[[1,"container-fluid"],[1,"row"],[1,"col-md-12","title"],[1,"col-md-12"],[1,"material-icons"],[3,"dataSource","displayedColumns","selectInListFunction"],["class","container-fluid",4,"ngIf"],[1,"col-md-12","information-title"],[1,"row","col-md-12"],[1,"row","col-md-5"],["type","file","accept",".pdf",1,"file-upload",3,"ngModel","ngModelOptions","ngModelChange","change"],[4,"ngIf"],[1,"row","col-md-7"],[3,"formGroup"],["class","col-md-12","appearance","outline",4,"ngIf"],["class","col-md-6","appearance","outline",4,"ngIf"],["appearance","outline",1,"col-md-6"],[1,"required-field"],["matInput","","name","amountTransfered","formControlName","amountTransfered","type","number",3,"ngModel","ngModelChange"],[1,"col-md-10"],[1,"col-md-2"],["mat-raised-button","",1,"button-red",3,"disabled","click"],[1,"material-icons","color__white"],[3,"dataSource","displayedColumns"],[1,"file-upload"],["type","application/pdf","width","100%","height","500",3,"data"],["width","100%","height","500",3,"src"],["appearance","outline",1,"col-md-12"],["name","company","formControlName","company",3,"ngModel","ngModelChange"],[3,"value","click",4,"ngFor","ngForOf"],[3,"value","click"],["matInput","","readonly","",3,"value"],["matInput","","name","remainingVoucherBalance","formControlName","remainingVoucherBalance","type","number","readonly","",3,"value"]],template:function(e,t){1&e&&(g["\u0275\u0275elementStart"](0,"form"),g["\u0275\u0275elementStart"](1,"div",0),g["\u0275\u0275elementStart"](2,"div",1),g["\u0275\u0275elementStart"](3,"div",2),g["\u0275\u0275elementStart"](4,"mat-label"),g["\u0275\u0275elementStart"](5,"mat-icon"),g["\u0275\u0275text"](6,"view_list"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275text"](7," Voucher Replenishment "),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275element"](8,"hr"),g["\u0275\u0275elementStart"](9,"div",3),g["\u0275\u0275elementStart"](10,"b"),g["\u0275\u0275elementStart"](11,"b",4),g["\u0275\u0275text"](12,"error_outline"),g["\u0275\u0275elementEnd"](),g["\u0275\u0275text"](13," Note: Select enrolled voucher to add fund or view amount replenishments made."),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"](),g["\u0275\u0275element"](14,"br"),g["\u0275\u0275elementStart"](15,"app-form-list",5),g["\u0275\u0275listener"]("selectInListFunction",(function(){return t.getVoucherTrasnferDetails()})),g["\u0275\u0275elementEnd"](),g["\u0275\u0275element"](16,"br"),g["\u0275\u0275template"](17,j,42,12,"div",6),g["\u0275\u0275elementEnd"](),g["\u0275\u0275elementEnd"]()),2&e&&(g["\u0275\u0275advance"](15),g["\u0275\u0275property"]("dataSource",t.dataSource)("displayedColumns",t.displayedColumns),g["\u0275\u0275advance"](2),g["\u0275\u0275property"]("ngIf","ROLE_APPLICANT"===(null==t.currentUser?null:t.currentUser.userRole.name)||"ROLE_ACCOUNTING"===(null==t.currentUser?null:t.currentUser.userRole.name)&&!0===t.previewDocument))},directives:[c.J,c.u,c.v,R.g,E.a,x.a,l.t,c.d,c.t,c.w,c.l,R.c,A.b,c.z,c.j,D.b,I.a,l.s,V.m],styles:[".button-green[_ngcontent-%COMP%]{background-color:green;color:#fff}.information-title[_ngcontent-%COMP%]{text-align:center;font-weight:700;font-size:24px}"]}),N)}],_=((O=o((function e(){i(this,e)}))).\u0275mod=g["\u0275\u0275defineNgModule"]({type:O}),O.\u0275inj=g["\u0275\u0275defineInjector"]({factory:function(e){return new(e||O)},imports:[[s.f.forChild(P)],s.f]}),O),z=a("tk/3"),q=a("7Tf7"),H=((B=o((function e(){i(this,e)}))).\u0275mod=g["\u0275\u0275defineNgModule"]({type:B}),B.\u0275inj=g["\u0275\u0275defineInjector"]({factory:function(e){return new(e||B)},imports:[[l.c,_,z.b,c.D,c.n,p.k,q.a]]}),B)}}])}();